[
  {
    "question": "What's the relationship between Supplier Qualifications and average Total Price across departments?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "supplier_qualifications": "$supplier_qualifications"
            },
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.department_name": 1,
            "_id.supplier_qualifications": 1
          }
        }
      ]
    },
    "result_count": 2327
  },
  {
    "question": "How does the use of CalCard vary across different Acquisition Methods?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "acquisition_method": "$acquisition_method",
              "calcard": "$calcard"
            },
            "total_purchases": {
              "$sum": "$total_price"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.acquisition_method": 1,
            "_id.calcard": 1
          }
        }
      ]
    },
    "result_count": 35
  },
  {
    "question": "What's the correlation between Classification Codes and Unit Price for IT Goods?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "item_description": {
              "$regex": "IT",
              "$options": "i"
            }
          }
        },
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": {
              "classification_code": "$classification_codes",
              "unit_price": "$unit_price"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.unit_price": 1
          }
        }
      ]
    },
    "result_count": 48730
  },
  {
    "question": "Compare the average Total Price between purchases with and without LPA Numbers.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "has_lpa": {
                "$cond": {
                  "if": {
                    "$ne": [
                      "$lpa_number",
                      null
                    ]
                  },
                  "then": true,
                  "else": false
                }
              }
            },
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How does the Unit Price vary within each Segment Title across different fiscal years?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "segment_title": "$segment_title",
              "fiscal_year": "$fiscal_year"
            },
            "unit_prices": {
              "$push": "$unit_price"
            }
          }
        },
        {
          "$addFields": {
            "unit_price_stats": {
              "$let": {
                "vars": {
                  "prices": "$unit_prices"
                },
                "in": {
                  "min": {
                    "$min": "$$prices"
                  },
                  "max": {
                    "$max": "$$prices"
                  },
                  "avg": {
                    "$avg": "$$prices"
                  }
                }
              }
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "unit_price_stats": 1
          }
        }
      ]
    },
    "result_count": 170
  },
  {
    "question": "What percentage of purchases in each Family Title are processed through CalCard?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "calcard": true
          }
        },
        {
          "$group": {
            "_id": "$family_title",
            "calcard_total": {
              "$sum": "$total_price"
            },
            "total": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "calcard_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$calcard_total",
                    "$total"
                  ]
                },
                100
              ]
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "For each Department Name, what is the ratio of unique Supplier Codes to total purchase orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name"
            },
            "unique_suppliers": {
              "$addToSet": "$supplier_code"
            },
            "total_pos": {
              "$sum": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "department_name": "$_id.department_name",
            "supplier_po_ratio": {
              "$divide": [
                {
                  "$size": "$unique_suppliers"
                },
                "$total_pos"
              ]
            }
          }
        }
      ]
    },
    "result_count": 110
  },
  {
    "question": "Compare the average Total Price between different Supplier Qualification categories.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_qualifications",
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 242
  },
  {
    "question": "What is the distribution of Sub-Acquisition Methods within each Segment Title across fiscal years?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "segment_title": "$segment_title",
              "sub_acquisition_method": "$sub_acquisition_method",
              "fiscal_year": "$fiscal_year"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.segment_title": 1,
            "_id.sub_acquisition_method": 1,
            "_id.fiscal_year": 1
          }
        }
      ]
    },
    "result_count": 876
  },
  {
    "question": "What percentage of high-value purchases (>$50,000) have matching LPA Numbers across different departments?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 50000
            }
          }
        },
        {
          "$group": {
            "_id": {
              "lpa_number": "$lpa_number",
              "department_name": "$department_name"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.lpa_number",
            "departments": {
              "$push": "$_id.department_name"
            },
            "total_count": {
              "$sum": "$count"
            }
          }
        },
        {
          "$match": {
            "departments.1": {
              "$exists": true
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "percentage": {
              "$multiply": [
                {
                  "$divide": [
                    {
                      "$size": {
                        "$filter": {
                          "input": "$departments",
                          "cond": {
                            "$gt": [
                              {
                                "$strLenCP": "$$this"
                              },
                              0
                            ]
                          }
                        }
                      }
                    },
                    {
                      "$size": "$departments"
                    }
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_percentage": {
              "$avg": "$percentage"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Compare the average Quantity ordered between CalCard and non-CalCard purchases within each Class Title.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "class_title": "$class_title",
              "calcard": "$calcard"
            },
            "avg_quantity": {
              "$avg": "$quantity"
            }
          }
        },
        {
          "$sort": {
            "_id.class_title": 1,
            "_id.calcard": 1
          }
        }
      ]
    },
    "result_count": 2670
  },
  {
    "question": "What is the relationship between Supplier Zip Code distances and Total Price within each Acquisition Type?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "acquisition_type": "$acquisition_type",
              "supplier_zip_code": "$supplier_zip_code"
            },
            "total_price": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.acquisition_type": 1,
            "total_price": -1
          }
        }
      ]
    },
    "result_count": 5850
  },
  {
    "question": "What is the distribution of Classification Codes within each Sub-Acquisition Method?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": {
              "sub_acquisition_method": "$sub_acquisition_method",
              "classification_code": "$classification_codes"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.sub_acquisition_method",
            "classification_codes": {
              "$push": {
                "code": "$_id.classification_code",
                "count": "$count"
              }
            }
          }
        }
      ]
    },
    "result_count": 17
  },
  {
    "question": "Compare the average time between Purchase Date and Creation Date across different Acquisition Methods.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_method",
            "avg_time_diff": {
              "$avg": {
                "$divide": [
                  {
                    "$subtract": [
                      "$purchase_date",
                      "$creation_date"
                    ]
                  },
                  86400000
                ]
              }
            }
          }
        }
      ]
    },
    "result_count": 20
  },
  {
    "question": "What is the seasonal pattern of Quantity ordered for each Family Title?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "family_title": "$family_title",
              "month": {
                "$month": "$purchase_date"
              }
            },
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        },
        {
          "$sort": {
            "_id.family_title": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 4265
  },
  {
    "question": "What percentage of purchases in each Segment have matching Requisition Numbers and Purchase Order Numbers?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "segment": "$segment",
              "has_matching_numbers": {
                "$cond": {
                  "if": {
                    "$eq": [
                      "$requisition_number",
                      "$purchase_order_number"
                    ]
                  },
                  "then": true,
                  "else": false
                }
              }
            },
            "total_purchases": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.segment",
            "total": {
              "$sum": "$total_purchases"
            },
            "matching_numbers": {
              "$sum": {
                "$cond": [
                  "$_id.has_matching_numbers",
                  "$total_purchases",
                  0
                ]
              }
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "segment": "$_id",
            "percentage_matching": {
              "$multiply": [
                {
                  "$divide": [
                    "$matching_numbers",
                    "$total"
                  ]
                },
                100
              ]
            }
          }
        }
      ]
    },
    "result_count": 57
  },
  {
    "question": "How does the average Total Price vary by Location within each Class Title?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "location": "$location",
              "class_title": "$class_title"
            },
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.class_title": 1,
            "_id.location": 1
          }
        }
      ]
    },
    "result_count": 37994
  },
  {
    "question": "What is the distribution of Supplier Qualifications within each Family across different fiscal years?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "family": "$family",
              "supplier_qualifications": "$supplier_qualifications",
              "fiscal_year": "$fiscal_year"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.family": 1,
            "_id.supplier_qualifications": 1,
            "_id.fiscal_year": 1
          }
        }
      ]
    },
    "result_count": 7971
  },
  {
    "question": "Show me all purchases where the Total Price is above $10,000 and CalCard is 'Yes'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 10000
            },
            "calcard": "Yes"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "How many purchase orders were created each month by the Department of Technology in FY 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014",
            "department_name": "Department of Technology"
          }
        },
        {
          "$project": {
            "month": {
              "$month": "$creation_date"
            },
            "purchase_order_number": 1
          }
        },
        {
          "$group": {
            "_id": {
              "month": "$month"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List all suppliers who had more than 5 orders with the same Item Name in a single month",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$item_name"
        },
        {
          "$group": {
            "_id": {
              "supplier_name": "$supplier_name",
              "item_name": "$item_name",
              "month": {
                "$month": "$purchase_date"
              },
              "year": {
                "$year": "$purchase_date"
              }
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "count": {
              "$gt": 5
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.supplier_name",
            "items": {
              "$push": {
                "item_name": "$_id.item_name",
                "month": "$_id.month",
                "year": "$_id.year",
                "count": "$count"
              }
            }
          }
        }
      ]
    },
    "result_count": 223
  },
  {
    "question": "What was the total spending by Location for purchases with Supplier Qualification 'SB'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_qualifications": "SB"
          }
        },
        {
          "$group": {
            "_id": "$location",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 57
  },
  {
    "question": "List all purchases where the Quantity is greater than 100 and Unit Price is less than $50",
    "query": {
      "find": {
        "quantity": {
          "$gt": 100
        },
        "unit_price": {
          "$lt": 50
        }
      }
    },
    "result_count": 0
  },
  {
    "question": "Which Department Name had the highest total spending on items with Family Title containing 'Software'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "family_title": {
              "$regex": "Software",
              "$options": "i"
            }
          }
        },
        {
          "$group": {
            "_id": "$department_name",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Show me the number of unique Supplier Codes used by each Department Name in FY 2014-2015",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2014",
                "2015"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "supplier_code": "$supplier_code"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.department_name",
            "unique_supplier_codes": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the average Total Price of purchases by Acquisition Method where LPA Number is not null?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "lpa_number": {
              "$ne": null
            }
          }
        },
        {
          "$group": {
            "_id": "$acquisition_method",
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 20
  },
  {
    "question": "List all Item Names purchased by more than 3 different departments in a single month",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "item_name": "$item_name",
              "month": {
                "$month": "$purchase_date"
              },
              "year": {
                "$year": "$purchase_date"
              }
            },
            "departments": {
              "$addToSet": "$department_name"
            }
          }
        },
        {
          "$match": {
            "departments.length": {
              "$gt": 3
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": "$_id.item_name"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show the total monthly spending by Department Name where Supplier Zip Code starts with '956'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$regex": "^956"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "month": {
                "$month": "$purchase_date"
              }
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.department_name": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 739
  },
  {
    "question": "Which Supplier Name had the highest number of orders under $1000 with CalCard 'Yes'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$lt": 1000
            },
            "calcard": "Yes"
          }
        },
        {
          "$group": {
            "_id": "$supplier_name",
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "order_count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Find all purchases where the Total Price doesn't match Quantity multiplied by Unit Price",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "$expr": {
              "$not": {
                "$eq": [
                  "$total_price",
                  {
                    "$multiply": [
                      "$quantity",
                      "$unit_price"
                    ]
                  }
                ]
              }
            }
          }
        }
      ]
    },
    "result_count": 10372
  },
  {
    "question": "What is the average order value by Sub-Acquisition Method for each Department Name?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "sub_acquisition_method": "$sub_acquisition_method"
            },
            "total_order_value": {
              "$sum": "$total_price"
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$addFields": {
            "average_order_value": {
              "$divide": [
                "$total_order_value",
                "$order_count"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.department_name",
            "sub_acquisition_methods": {
              "$push": {
                "sub_acquisition_method": "$_id.sub_acquisition_method",
                "average_order_value": "$average_order_value"
              }
            }
          }
        }
      ]
    },
    "result_count": 110
  },
  {
    "question": "Show me all Item Names purchased through both 'WSCA/Coop' and 'Leveraged Procurement Agreement' Acquisition Methods",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": {
              "$in": [
                "WSCA/Coop",
                "Leveraged Procurement Agreement"
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": 1
          }
        }
      ]
    },
    "result_count": 10202
  },
  {
    "question": "List departments that spent more than $50,000 in a single day, including the Purchase Date",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "purchase_date": "$purchase_date"
            },
            "total_spent": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$match": {
            "total_spent": {
              "$gt": 50000
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "department_name": "$_id.department_name",
            "purchase_date": "$_id.purchase_date",
            "total_spent": 1
          }
        }
      ]
    },
    "result_count": 12711
  },
  {
    "question": "Show the distribution of Total Price by Classification Codes for IT-related purchases",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "item_description": {
              "$regex": "IT",
              "$options": "i"
            }
          }
        },
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": "$classification_codes",
            "total_price": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 8322
  },
  {
    "question": "Show all Supplier Names who received orders from at least 5 different Locations in a single month",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$location"
        },
        {
          "$group": {
            "_id": {
              "supplier_name": "$supplier_name",
              "month": {
                "$month": "$purchase_date"
              },
              "year": {
                "$year": "$purchase_date"
              }
            },
            "locations": {
              "$addToSet": "$location"
            }
          }
        },
        {
          "$match": {
            "locations.length": {
              "$gte": 5
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.supplier_name",
            "months": {
              "$push": {
                "month": "$_id.month",
                "year": "$_id.year",
                "locations": "$locations"
              }
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List the top 10 most expensive purchases by Total Price where Acquisition Method is 'NCB'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "NCB"
          }
        },
        {
          "$sort": {
            "total_price": -1
          }
        },
        {
          "$limit": 10
        }
      ]
    },
    "result_count": 10
  },
  {
    "question": "Show me all Department Names where the average time between Creation Date and Purchase Date exceeds 14 days",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "time_diff": {
              "$divide": [
                {
                  "$subtract": [
                    "$purchase_date",
                    "$creation_date"
                  ]
                },
                86400000
              ]
            }
          }
        },
        {
          "$match": {
            "time_diff": {
              "$gt": 14
            }
          }
        },
        {
          "$group": {
            "_id": "$department_name"
          }
        }
      ]
    },
    "result_count": 73
  },
  {
    "question": "List Item Names that were purchased using every Sub-Acquisition Method available in the database",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$sub_acquisition_method",
            "item_names": {
              "$addToSet": "$item_name"
            }
          }
        },
        {
          "$unwind": "$item_names"
        },
        {
          "$group": {
            "_id": null,
            "all_item_names": {
              "$addToSet": "$item_names"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the percentage of Total Price spent through each Acquisition Type by Location '95814'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": "95814"
          }
        },
        {
          "$group": {
            "_id": {
              "acquisition_type": "$acquisition_type"
            },
            "total_price_sum": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "acquisition_types": {
              "$push": {
                "acquisition_type": "$_id.acquisition_type",
                "total_price_sum": "$total_price_sum"
              }
            },
            "grand_total": {
              "$sum": "$total_price_sum"
            }
          }
        },
        {
          "$unwind": "$acquisition_types"
        },
        {
          "$addFields": {
            "acquisition_types.percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$acquisition_types.total_price_sum",
                    "$grand_total"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "acquisition_type_percentages": {
              "$push": "$acquisition_types"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List Department Names where more than 30% of their Total Price is spent with suppliers having Supplier Qualification 'DVBE'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_qualifications": "DVBE"
          }
        },
        {
          "$group": {
            "_id": "$department_name",
            "total_price": {
              "$sum": "$total_price"
            },
            "dvbe_spend": {
              "$sum": {
                "$cond": [
                  {
                    "$eq": [
                      "$supplier_qualifications",
                      "DVBE"
                    ]
                  },
                  "$total_price",
                  0
                ]
              }
            }
          }
        },
        {
          "$addFields": {
            "dvbe_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$dvbe_spend",
                    "$total_price"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$match": {
            "dvbe_percentage": {
              "$gt": 30
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which Commodity Title had the highest number of purchases with non-matching Purchase Order Number and Requisition Number?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "purchase_order_number": {
              "$ne": "$requisition_number"
            }
          }
        },
        {
          "$group": {
            "_id": "$commodity_title",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Show me the trend of average Quantity ordered per month for each Family Title in FY 2013-2014",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": {
              "month": {
                "$month": "$creation_date"
              },
              "family_title": "$family_title"
            },
            "avg_quantity": {
              "$avg": "$quantity"
            }
          }
        },
        {
          "$sort": {
            "_id.month": 1,
            "_id.family_title": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show all Department Names where CalCard purchases account for more than 25% of their total order count",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "calcard": true
          }
        },
        {
          "$group": {
            "_id": "$department_name",
            "calcard_count": {
              "$sum": 1
            },
            "total_count": {
              "$sum": 1
            }
          }
        },
        {
          "$addFields": {
            "calcard_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$calcard_count",
                    "$total_count"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$match": {
            "calcard_percentage": {
              "$gt": 25
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the average Total Price by Acquisition Method for each Class Title?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "acquisition_method": "$acquisition_method",
              "class_title": "$class_title"
            },
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 10571
  },
  {
    "question": "List the top 5 Supplier Names by total number of unique Item Names provided",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$item_name"
        },
        {
          "$group": {
            "_id": {
              "supplier_name": "$supplier_name",
              "item_name": "$item_name"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.supplier_name",
            "unique_item_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "unique_item_count": -1
          }
        },
        {
          "$limit": 5
        },
        {
          "$project": {
            "_id": 0,
            "supplier_name": "$_id",
            "unique_item_count": 1
          }
        }
      ]
    },
    "result_count": 5
  },
  {
    "question": "What is the monthly trend of average Unit Price for each Segment where Total Price exceeds $10,000?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 10000
            }
          }
        },
        {
          "$group": {
            "_id": {
              "segment": "$segment",
              "month": {
                "$month": "$purchase_date"
              }
            },
            "avg_unit_price": {
              "$avg": "$unit_price"
            }
          }
        },
        {
          "$sort": {
            "_id.segment": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 725
  },
  {
    "question": "Show Department Names where more than 50% of their purchases have matching LPA Numbers",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$department_name",
            "total_purchases": {
              "$sum": 1
            },
            "matching_lpa_purchases": {
              "$sum": {
                "$cond": [
                  {
                    "$ne": [
                      "$lpa_number",
                      null
                    ]
                  },
                  1,
                  0
                ]
              }
            }
          }
        },
        {
          "$match": {
            "$expr": {
              "$gt": [
                {
                  "$divide": [
                    "$matching_lpa_purchases",
                    "$total_purchases"
                  ]
                },
                0.5
              ]
            }
          }
        }
      ]
    },
    "result_count": 110
  },
  {
    "question": "What is the total number of orders and total spending by quarter for FY 2014-2015?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                2014,
                2015
              ]
            }
          }
        },
        {
          "$addFields": {
            "quarter": {
              "$cond": [
                {
                  "$and": [
                    {
                      "$gte": [
                        {
                          "$month": "$purchase_date"
                        },
                        1
                      ]
                    },
                    {
                      "$lte": [
                        {
                          "$month": "$purchase_date"
                        },
                        3
                      ]
                    }
                  ]
                },
                1,
                {
                  "$cond": [
                    {
                      "$and": [
                        {
                          "$gte": [
                            {
                              "$month": "$purchase_date"
                            },
                            4
                          ]
                        },
                        {
                          "$lte": [
                            {
                              "$month": "$purchase_date"
                            },
                            6
                          ]
                        }
                      ]
                    },
                    2,
                    {
                      "$cond": [
                        {
                          "$and": [
                            {
                              "$gte": [
                                {
                                  "$month": "$purchase_date"
                                },
                                7
                              ]
                            },
                            {
                              "$lte": [
                                {
                                  "$month": "$purchase_date"
                                },
                                9
                              ]
                            }
                          ]
                        },
                        3,
                        4
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "$group": {
            "_id": {
              "quarter": "$quarter",
              "fiscal_year": "$fiscal_year"
            },
            "total_orders": {
              "$sum": 1
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show the weekly order volume (count of Purchase Order Numbers) trend for FY 2013-2014",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$project": {
            "purchase_order_number": 1,
            "week": {
              "$week": "$purchase_date"
            },
            "year": {
              "$year": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "week": "$week",
              "year": "$year"
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.year": 1,
            "_id.week": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List all Item Names that were ordered at least once every month in FY 2013-2014",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": {
              "item_name": "$item_name",
              "month": {
                "$month": "$purchase_date"
              }
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.item_name",
            "months": {
              "$addToSet": "$_id.month"
            }
          }
        },
        {
          "$match": {
            "months": {
              "$size": 12
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": "$_id"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the average number of line items per Purchase Order Number by Department Name?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$item_name"
        },
        {
          "$group": {
            "_id": {
              "purchase_order_number": "$purchase_order_number",
              "department_name": "$department_name"
            },
            "line_item_count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.department_name",
            "avg_line_items": {
              "$avg": "$line_item_count"
            }
          }
        }
      ]
    },
    "result_count": 110
  },
  {
    "question": "Show the monthly spending pattern (sum of Total Price) for orders created in FY 2013-2014",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": {
              "year": {
                "$year": "$creation_date"
              },
              "month": {
                "$month": "$creation_date"
              }
            },
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.year": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List Item Names that appeared in more than 100 different Purchase Order Numbers",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "item_name": "$item_name",
              "purchase_order_number": "$purchase_order_number"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.item_name",
            "purchase_order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "purchase_order_count": {
              "$gt": 100
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": "$_id"
          }
        }
      ]
    },
    "result_count": 61
  },
  {
    "question": "Show the count of Purchase Order Numbers created in the last week of each quarter",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "quarter": {
              "$toInt": {
                "$add": [
                  {
                    "$divide": [
                      {
                        "$subtract": [
                          {
                            "$month": "$creation_date"
                          },
                          1
                        ]
                      },
                      3
                    ]
                  },
                  1
                ]
              }
            },
            "week": {
              "$week": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "week": {
              "$gte": 39,
              "$lte": 40
            }
          }
        },
        {
          "$group": {
            "_id": {
              "quarter": "$quarter"
            },
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 2
  },
  {
    "question": "Show the monthly trend of new Supplier Codes being used for the first time",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "year": {
                "$year": "$creation_date"
              },
              "month": {
                "$month": "$creation_date"
              }
            },
            "new_supplier_codes": {
              "$addToSet": "$supplier_code"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "year": "$_id.year",
            "month": "$_id.month",
            "new_supplier_codes_count": {
              "$size": "$new_supplier_codes"
            }
          }
        },
        {
          "$sort": {
            "year": 1,
            "month": 1
          }
        }
      ]
    },
    "result_count": 36
  },
  {
    "question": "What percentage of total orders were created in the last 5 days of each month?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "day_of_month": {
              "$dayOfMonth": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "day_of_month": {
              "$gte": 26
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_orders": {
              "$sum": 1
            },
            "orders_in_last_five_days": {
              "$sum": 1
            }
          }
        },
        {
          "$addFields": {
            "percentage_in_last_five_days": {
              "$multiply": [
                {
                  "$divide": [
                    "$ordersInLastFiveDays",
                    "$totalOrders"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "percentage_in_last_five_days": 1
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List the top 10 months by total number of unique Item Names ordered",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "month": {
              "$dateToString": {
                "format": "%Y-%m",
                "date": "$creation_date"
              }
            },
            "item_name": 1
          }
        },
        {
          "$group": {
            "_id": {
              "month": "$month"
            },
            "unique_items": {
              "$addToSet": "$item_name"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "month": "$_id.month",
            "unique_item_count": {
              "$size": "$unique_items"
            }
          }
        },
        {
          "$sort": {
            "unique_item_count": -1
          }
        },
        {
          "$limit": 10
        }
      ]
    },
    "result_count": 10
  },
  {
    "question": "What's the average number of days between Creation Date and Purchase Date for orders above $50,000?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 50000
            }
          }
        },
        {
          "$addFields": {
            "days_between": {
              "$divide": [
                {
                  "$subtract": [
                    "$purchase_date",
                    "$creation_date"
                  ]
                },
                86400000
              ]
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_days_between": {
              "$avg": "$days_between"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Show the number of Purchase Order Numbers created on the first business day of each month",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "creation_date_day": {
              "$dayOfMonth": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "creation_date_day": 1
          }
        },
        {
          "$group": {
            "_id": {
              "year": {
                "$year": "$creation_date"
              },
              "month": {
                "$month": "$creation_date"
              }
            },
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 30
  },
  {
    "question": "Show the hourly pattern of order creation (Creation Date) during business hours",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "creation_date": 1,
            "hour": {
              "$hour": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "hour": {
              "$gte": 8,
              "$lte": 17
            }
          }
        },
        {
          "$group": {
            "_id": "$hour",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What percentage of total orders (Purchase Order Numbers) were created between 3-5 PM?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "purchase_order_number": 1,
            "creation_hour": {
              "$hour": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "creation_hour": {
              "$gte": 15,
              "$lte": 17
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_orders": {
              "$sum": 1
            },
            "orders_3pm_5pm": {
              "$sum": {
                "$cond": [
                  {
                    "$and": [
                      {
                        "$gte": [
                          "$creation_hour",
                          15
                        ]
                      },
                      {
                        "$lte": [
                          "$creation_hour",
                          17
                        ]
                      }
                    ]
                  },
                  1,
                  0
                ]
              }
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$orders_3pm_5pm",
                    "$total_orders"
                  ]
                },
                100
              ]
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show departments where more than 30% of their orders were created on Fridays",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$department_name",
            "total_orders": {
              "$sum": 1
            },
            "friday_orders": {
              "$sum": {
                "$cond": [
                  {
                    "$eq": [
                      {
                        "$dayOfWeek": "$creation_date"
                      },
                      6
                    ]
                  },
                  1,
                  0
                ]
              }
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "friday_order_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$friday_orders",
                    "$total_orders"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$match": {
            "friday_order_percentage": {
              "$gt": 30
            }
          }
        }
      ]
    },
    "result_count": 10
  },
  {
    "question": "Which week of FY 2013-2014 had the highest total spending (sum of Total Price)?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": {
              "week": {
                "$week": "$purchase_date"
              }
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all Purchase Order Numbers with more than 15 different Item Names",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$item_name"
        },
        {
          "$group": {
            "_id": "$purchase_order_number",
            "item_names": {
              "$addToSet": "$item_name"
            }
          }
        },
        {
          "$match": {
            "item_names.length": {
              "$gt": 15
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "purchase_order_number": "$_id"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What's the typical order value (Total Price) by day of week for each Department Name?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "day_of_week": {
              "$dayOfWeek": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "day_of_week": "$day_of_week"
            },
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.department_name": 1,
            "_id.day_of_week": 1
          }
        }
      ]
    },
    "result_count": 716
  },
  {
    "question": "What's the average number of unique Supplier Names used per month by each Department Name?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "month": {
                "$month": "$creation_date"
              },
              "year": {
                "$year": "$creation_date"
              },
              "department_name": "$department_name"
            },
            "unique_suppliers": {
              "$addToSet": "$supplier_name"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "month": "$_id.month",
            "year": "$_id.year",
            "department_name": "$_id.department_name",
            "num_unique_suppliers": {
              "$size": "$unique_suppliers"
            }
          }
        },
        {
          "$group": {
            "_id": "$department_name",
            "avg_unique_suppliers": {
              "$avg": "$num_unique_suppliers"
            }
          }
        }
      ]
    },
    "result_count": 110
  },
  {
    "question": "List Purchase Order Numbers where all items were ordered from the same Supplier Code",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "purchase_order_number": "$purchase_order_number",
              "supplier_code": "$supplier_code"
            },
            "item_count": {
              "$sum": 1
            },
            "unique_suppliers": {
              "$addToSet": "$supplier_code"
            }
          }
        },
        {
          "$match": {
            "unique_suppliers": {
              "$size": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "purchase_order_number": "$_id.purchase_order_number"
          }
        }
      ]
    },
    "result_count": 125492
  },
  {
    "question": "Which Department Name shows the most consistent daily order volume?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "creation_date": {
                "$dateToString": {
                  "format": "%Y-%m-%d",
                  "date": "$creation_date"
                }
              }
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.department_name",
            "daily_orders": {
              "$push": {
                "date": "$_id.creation_date",
                "count": "$order_count"
              }
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "department_name": "$_id",
            "daily_order_stdev": {
              "$stdDevPop": "$daily_orders.count"
            }
          }
        },
        {
          "$sort": {
            "daily_order_stdev": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Show months where the order volume was 20% above the yearly average",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "year": {
                "$year": "$purchase_date"
              },
              "month": {
                "$month": "$purchase_date"
              }
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.year",
            "month_counts": {
              "$push": {
                "month": "$_id.month",
                "count": "$count"
              }
            },
            "total_count": {
              "$sum": "$count"
            }
          }
        },
        {
          "$unwind": "$month_counts"
        },
        {
          "$addFields": {
            "month_avg": {
              "$divide": [
                "$totalCount",
                12
              ]
            }
          }
        },
        {
          "$addFields": {
            "month_counts.above_avg": {
              "$cond": {
                "if": {
                  "$gt": [
                    "$monthCounts.count",
                    {
                      "$multiply": [
                        "$monthAvg",
                        1.2
                      ]
                    }
                  ]
                },
                "then": true,
                "else": false
              }
            }
          }
        },
        {
          "$match": {
            "month_counts.above_avg": true
          }
        },
        {
          "$project": {
            "_id": 0,
            "year": "$_id.year",
            "month": "$month_counts.month"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List Item Names that were ordered in bulk (Quantity > 100) more than 5 times",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "quantity": {
              "$gt": 100
            }
          }
        },
        {
          "$group": {
            "_id": "$item_name",
            "bulk_order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "bulk_order_count": {
              "$gt": 5
            }
          }
        }
      ]
    },
    "result_count": 292
  },
  {
    "question": "What's the ratio of rush orders (Purchase Date same as Creation Date) by Department Name?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "is_rush_order": {
              "$cmp": [
                "$creation_date",
                "$purchase_date"
              ]
            }
          }
        },
        {
          "$match": {
            "is_rush_order": 0
          }
        },
        {
          "$group": {
            "_id": "$department_name",
            "total_orders": {
              "$sum": 1
            },
            "rush_orders": {
              "$sum": 1
            }
          }
        },
        {
          "$addFields": {
            "rush_order_ratio": {
              "$divide": [
                "$rush_orders",
                "$total_orders"
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "rush_order_ratio": 1
          }
        }
      ]
    },
    "result_count": 92
  },
  {
    "question": "List Supplier Names that received more than 50% of their total orders in a single quarter",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "supplier_name": "$supplier_name",
              "quarter": {
                "$concat": [
                  {
                    "$toString": {
                      "$year": "$purchase_date"
                    }
                  },
                  "-Q",
                  {
                    "$toString": {
                      "$add": [
                        {
                          "$ceil": {
                            "$divide": [
                              {
                                "$month": "$purchase_date"
                              },
                              3
                            ]
                          }
                        },
                        {
                          "$cond": [
                            {
                              "$gt": [
                                {
                                  "$mod": [
                                    {
                                      "$month": "$purchase_date"
                                    },
                                    3
                                  ]
                                },
                                0
                              ]
                            },
                            0,
                            1
                          ]
                        }
                      ]
                    }
                  }
                ]
              }
            },
            "total_orders": {
              "$sum": 1
            },
            "total_price": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$addFields": {
            "max_orders_in_quarter": {
              "$max": "$total_orders"
            }
          }
        },
        {
          "$match": {
            "total_orders": {
              "$gte": {
                "$multiply": [
                  0.5,
                  "$max_orders_in_quarter"
                ]
              }
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "supplier_name": "$_id.supplier_name"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Which Department Names have the highest percentage of weekend order creation?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "is_weekend": {
              "$cond": {
                "if": {
                  "$in": [
                    {
                      "$dayOfWeek": "$creation_date"
                    },
                    [
                      1,
                      7
                    ]
                  ]
                },
                "then": true,
                "else": false
              }
            }
          }
        },
        {
          "$match": {
            "is_weekend": true
          }
        },
        {
          "$group": {
            "_id": "$department_name",
            "weekend_count": {
              "$sum": 1
            },
            "total_count": {
              "$sum": 1
            }
          }
        },
        {
          "$addFields": {
            "weekend_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$weekendCount",
                    "$totalCount"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$sort": {
            "weekend_percentage": -1
          }
        }
      ]
    },
    "result_count": 39
  },
  {
    "question": "What's the average number of unique Item Names ordered per week by Location?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "week_number": {
              "$week": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "week_number": "$week_number",
              "location": "$location"
            },
            "unique_item_names": {
              "$addToSet": "$item_name"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "week_number": "$_id.week_number",
            "location": "$_id.location",
            "num_unique_item_names": {
              "$size": "$unique_item_names"
            }
          }
        },
        {
          "$group": {
            "_id": "$location",
            "avg_unique_item_names": {
              "$avg": "$num_unique_item_names"
            }
          }
        }
      ]
    },
    "result_count": 3435
  },
  {
    "question": "Show the pattern of high-value orders (>$100,000) by day of week and time of day",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 100000
            }
          }
        },
        {
          "$project": {
            "day_of_week": {
              "$dayOfWeek": "$creation_date"
            },
            "hour_of_day": {
              "$hour": "$creation_date"
            },
            "total_price": 1
          }
        },
        {
          "$group": {
            "_id": {
              "day_of_week": "$day_of_week",
              "hour_of_day": "$hour_of_day"
            },
            "count": {
              "$sum": 1
            },
            "total_value": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.day_of_week": 1,
            "_id.hour_of_day": 1
          }
        }
      ]
    },
    "result_count": 7
  },
  {
    "question": "What's the distribution of order values (Total Price) by hour for each Acquisition Method?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "order_hour": {
              "$hour": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "acquisition_method": "$acquisition_method",
              "hour": "$order_hour"
            },
            "total_price": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.acquisition_method": 1,
            "_id.hour": 1
          }
        }
      ]
    },
    "result_count": 37
  },
  {
    "question": "Show Purchase Order Numbers where all items have identical Creation Date and Purchase Date",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "purchase_order_number": "$purchase_order_number",
              "creation_date": "$creation_date",
              "purchase_date": "$purchase_date"
            },
            "distinct_dates": {
              "$addToSet": {
                "creation_date": "$creation_date",
                "purchase_date": "$purchase_date"
              }
            }
          }
        },
        {
          "$match": {
            "distinct_dates.creation_date": {
              "$size": 1
            },
            "distinct_dates.purchase_date": {
              "$size": 1
            }
          }
        },
        {
          "$project": {
            "_id.purchase_order_number": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List all Item Names where Unit Price is above $1000 in the Education department",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "department_name": "Education",
            "unit_price": {
              "$gt": 1000
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show total spending (Total Price) by week for Location '95814'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": "95814"
          }
        },
        {
          "$group": {
            "_id": {
              "week": {
                "$week": "$purchase_date"
              },
              "year": {
                "$year": "$purchase_date"
              }
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.year": 1,
            "_id.week": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Find all Purchase Order Numbers where Quantity is greater than 100 in IT Services",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "department_name": "IT Services",
            "quantity": {
              "$gt": 100
            }
          }
        },
        {
          "$project": {
            "purchase_order_number": 1,
            "_id": 0
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List Item Names ordered more than 5 times by Department of Health",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "department_name": "Department of Health"
          }
        },
        {
          "$unwind": "$item_name"
        },
        {
          "$group": {
            "_id": "$item_name",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "count": {
              "$gt": 5
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Sum Total Price by Department Name where CalCard is 'Yes'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "calcard": "Yes"
          }
        },
        {
          "$group": {
            "_id": "$department_name",
            "total_price": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Find all orders where Unit Price multiplied by Quantity is over $5000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "calculated_total": {
              "$multiply": [
                "$unit_price",
                "$quantity"
              ]
            }
          }
        },
        {
          "$match": {
            "calculated_total": {
              "$gt": 5000
            }
          }
        }
      ]
    },
    "result_count": 88803
  },
  {
    "question": "List top 10 Supplier Names by total order count in FY 2013-2014",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name",
            "total_orders": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "total_orders": -1
          }
        },
        {
          "$limit": 10
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Count orders by Sub-Acquisition Method for each Department Name",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "sub_acquisition_method": "$sub_acquisition_method"
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.department_name": 1,
            "_id.sub_acquisition_method": 1
          }
        }
      ]
    },
    "result_count": 465
  },
  {
    "question": "Count orders by Location where Total Price is above $10000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 10000
            }
          }
        },
        {
          "$group": {
            "_id": "$location",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 2644
  },
  {
    "question": "Show total monthly spending where Supplier Qualification includes 'SB'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_qualifications": {
              "$regex": "SB"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "year": {
                "$year": "$purchase_date"
              },
              "month": {
                "$month": "$purchase_date"
              }
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.year": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 114
  },
  {
    "question": "Count Purchase Order Numbers by day of week for each Department Name",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "department_name": 1,
            "purchase_order_number": 1,
            "day_of_week": {
              "$dayOfWeek": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "day_of_week": "$day_of_week"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.department_name": 1,
            "_id.day_of_week": 1
          }
        }
      ]
    },
    "result_count": 716
  },
  {
    "question": "List all Item Names ordered by both Location '95814' and '95605'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": {
              "$in": [
                "95814",
                "95605"
              ]
            }
          }
        },
        {
          "$sort": {
            "location": 1,
            "item_name": 1
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": 1,
            "location": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show count of orders by Supplier Name where CalCard is 'No'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "calcard": "No"
          }
        },
        {
          "$group": {
            "_id": "$supplier_name",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List Purchase Order Numbers where same Item Name appears more than twice",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$item_name"
        },
        {
          "$group": {
            "_id": {
              "purchase_order_number": "$purchase_order_number",
              "item_name": "$item_name"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "count": {
              "$gt": 2
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.purchase_order_number"
          }
        }
      ]
    },
    "result_count": 1086
  },
  {
    "question": "Sum Quantity by Item Name for Department of Technology",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "department_name": "Department of Technology"
          }
        },
        {
          "$group": {
            "_id": "$item_name",
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show total spending by day where Supplier Qualification is 'DVBE'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_qualifications": "DVBE"
          }
        },
        {
          "$group": {
            "_id": {
              "day": {
                "$dayOfMonth": "$purchase_date"
              },
              "month": {
                "$month": "$purchase_date"
              },
              "year": {
                "$year": "$purchase_date"
              }
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.year": 1,
            "_id.month": 1,
            "_id.day": 1
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Find Item Names where average Quantity per order exceeds 50",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$item_name",
            "avg_quantity": {
              "$avg": "$quantity"
            }
          }
        },
        {
          "$match": {
            "avg_quantity": {
              "$gt": 50
            }
          }
        }
      ]
    },
    "result_count": 14267
  },
  {
    "question": "Count Purchase Order Numbers by Supplier Code for each month",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "supplier_code": 1,
            "purchase_order_number": 1,
            "month": {
              "$month": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "supplier_code": "$supplier_code",
              "month": "$month"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.supplier_code": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 44933
  },
  {
    "question": "Sum daily spending by Sub-Acquisition Method",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "sub_acquisition_method": "$sub_acquisition_method",
              "date": "$creation_date"
            },
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.sub_acquisition_method",
            "daily_spending": {
              "$push": {
                "date": "$_id.date",
                "total_spend": "$total_spend"
              }
            }
          }
        }
      ]
    },
    "result_count": 17
  },
  {
    "question": "Count orders by Normalized UNSPSC where Total Price exceeds $1000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 1000
            }
          }
        },
        {
          "$group": {
            "_id": "$normalized_unspsc",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 9506
  },
  {
    "question": "Show Purchase Order Numbers with more than 5 different Commodity Titles",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": {
              "purchase_order_number": "$purchase_order_number",
              "commodity_title": "$commodity_title"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.purchase_order_number",
            "commodity_titles": {
              "$addToSet": "$_id.commodity_title"
            }
          }
        },
        {
          "$match": {
            "commodity_titles.1": {
              "$exists": true
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "purchase_order_number": "$_id",
            "commodity_title_count": {
              "$size": "$commodity_titles"
            }
          }
        },
        {
          "$match": {
            "commodity_title_count": {
              "$gt": 5
            }
          }
        }
      ]
    },
    "result_count": 1079
  },
  {
    "question": "Sum monthly spending where LPA Number is not null",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "lpa_number": {
              "$ne": null
            }
          }
        },
        {
          "$group": {
            "_id": {
              "year": {
                "$year": "$creation_date"
              },
              "month": {
                "$month": "$creation_date"
              }
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.year": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 36
  },
  {
    "question": "Count orders by Class Title for each Department Name",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "class_title": "$class_title"
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.department_name": 1,
            "_id.class_title": 1
          }
        }
      ]
    },
    "result_count": 18625
  },
  {
    "question": "Count orders where Creation Date and Purchase Date match",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "creation_date": 1,
            "purchase_date": 1,
            "match": {
              "$eq": [
                "$creation_date",
                "$purchase_date"
              ]
            }
          }
        },
        {
          "$match": {
            "match": true
          }
        },
        {
          "$count": "matching_orders"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Sum weekly spending by Department Name where Total Price > $5000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 5000
            }
          }
        },
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "week": {
                "$week": "$purchase_date"
              }
            },
            "total_spent": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.department_name",
            "weekly_spending": {
              "$push": {
                "week": "$_id.week",
                "total_spent": "$total_spent"
              }
            }
          }
        }
      ]
    },
    "result_count": 108
  },
  {
    "question": "Show order count by Family for IT-related purchases",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "item_description": {
              "$regex": "IT",
              "$options": "i"
            }
          }
        },
        {
          "$group": {
            "_id": "$family_title",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 368
  },
  {
    "question": "Count orders by Supplier Qualification for each Location",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "location": "$location",
              "supplier_qualifications": "$supplier_qualifications"
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.location": 1,
            "_id.supplier_qualifications": 1
          }
        }
      ]
    },
    "result_count": 6484
  },
  {
    "question": "List total spending by day of week for each Acquisition Method",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "acquisition_method": "$acquisition_method",
              "day_of_week": {
                "$dayOfWeek": "$purchase_date"
              }
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.acquisition_method": 1,
            "_id.day_of_week": 1
          }
        }
      ]
    },
    "result_count": 155
  },
  {
    "question": "Show Item Names ordered at same Unit Price across all Departments",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "item_name": "$item_name",
              "unit_price": "$unit_price"
            },
            "departments": {
              "$addToSet": "$department_name"
            }
          }
        },
        {
          "$unwind": "$departments"
        },
        {
          "$group": {
            "_id": "$_id",
            "num_departments": {
              "$sum": 1
            },
            "departments": {
              "$push": "$departments"
            }
          }
        },
        {
          "$match": {
            "num_departments": {
              "$gt": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": "$_id.item_name",
            "unit_price": "$_id.unit_price",
            "departments": 1
          }
        },
        {
          "$sort": {
            "item_name": 1,
            "unit_price": 1
          }
        }
      ]
    },
    "result_count": 1077
  },
  {
    "question": "List Item Names with highest percentage of rush orders (same day Creation and Purchase Date)",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "is_rush_order": {
              "$eq": [
                "$creation_date",
                "$purchase_date"
              ]
            }
          }
        },
        {
          "$match": {
            "is_rush_order": true
          }
        },
        {
          "$group": {
            "_id": "$item_name",
            "total_rush_orders": {
              "$sum": 1
            },
            "total_orders": {
              "$sum": 1
            }
          }
        },
        {
          "$addFields": {
            "rush_order_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$totalRushOrders",
                    "$totalOrders"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$sort": {
            "rush_order_percentage": -1
          }
        }
      ]
    },
    "result_count": 47274
  },
  {
    "question": "Show monthly spending patterns for each Normalized UNSPSC category",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "month": {
              "$month": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "normalized_unspsc": "$normalized_unspsc",
              "month": "$month"
            },
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.normalized_unspsc": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 42670
  },
  {
    "question": "Find Supplier Names that exclusively serve single Department Name",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "supplier_name": "$supplier_name",
              "department_name": "$department_name"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.supplier_name",
            "departments": {
              "$push": "$_id.department_name"
            },
            "total_count": {
              "$sum": "$count"
            }
          }
        },
        {
          "$match": {
            "departments": {
              "$size": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "supplier_name": "$_id",
            "departments": 1
          }
        }
      ]
    },
    "result_count": 16237
  },
  {
    "question": "List Purchase Order Numbers where all items are from same Family Title",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": {
              "purchase_order_number": "$purchase_order_number",
              "family_title": "$family_title"
            },
            "item_count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.purchase_order_number",
            "family_titles": {
              "$addToSet": "$_id.family_title"
            },
            "total_items": {
              "$sum": "$item_count"
            }
          }
        },
        {
          "$match": {
            "family_titles": {
              "$size": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "purchase_order_number": "$_id"
          }
        }
      ]
    },
    "result_count": 115226
  },
  {
    "question": "Show weekly order volume for items with Classification Codes ending in '00'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": {
              "$elemMatch": {
                "$regex": "00$"
              }
            }
          }
        },
        {
          "$addFields": {
            "week": {
              "$isoWeek": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "week": "$week"
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.week": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show daily spending where Supplier Zip Code matches Location code",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$eq": "$location"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "date": "$creation_date",
              "location": "$location"
            },
            "daily_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.date": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Count orders by Commodity Title where Quantity is prime number",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "quantity": {
              "$in": [
                2,
                3,
                5,
                7,
                11,
                13,
                17,
                19,
                23,
                29,
                31,
                37,
                41,
                43,
                47,
                53,
                59,
                61,
                67,
                71,
                73,
                79,
                83,
                89,
                97
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$commodity_title",
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 3840
  },
  {
    "question": "List departments with highest percentage of single-item Purchase Order Numbers",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "purchase_order_number": "$purchase_order_number"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.department_name",
            "total_pos": {
              "$sum": 1
            },
            "single_item_pos": {
              "$sum": {
                "$cond": [
                  {
                    "$eq": [
                      "$count",
                      1
                    ]
                  },
                  1,
                  0
                ]
              }
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "department_name": "$_id",
            "single_item_po_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$single_item_pos",
                    "$total_pos"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$sort": {
            "single_item_po_percentage": -1
          }
        }
      ]
    },
    "result_count": 110
  },
  {
    "question": "Show Purchase Order Numbers where all items share same Class Title",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": {
              "purchase_order_number": "$purchase_order_number",
              "class_title": "$class_title"
            },
            "item_count": {
              "$sum": 1
            },
            "total_items": {
              "$sum": "$quantity"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.purchase_order_number",
            "class_titles": {
              "$push": {
                "class_title": "$_id.class_title",
                "item_count": "$item_count",
                "total_items": "$total_items"
              }
            },
            "po_item_count": {
              "$sum": "$item_count"
            }
          }
        },
        {
          "$match": {
            "class_titles.item_count": "$po_item_count"
          }
        },
        {
          "$project": {
            "_id": 0,
            "purchase_order_number": "$_id",
            "class_titles": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List Supplier Names with most diverse range of Item Names supplied",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$item_name"
        },
        {
          "$group": {
            "_id": {
              "supplier_name": "$supplier_name",
              "item_name": "$item_name"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.supplier_name",
            "unique_items": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "unique_items": -1
          }
        },
        {
          "$project": {
            "_id": 0,
            "supplier_name": "$_id",
            "unique_items": 1
          }
        }
      ]
    },
    "result_count": 20538
  },
  {
    "question": "Show total spending by Family Title where Unit Price ends in .99",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "unit_price": {
              "$regex": ".99$"
            }
          }
        },
        {
          "$group": {
            "_id": "$family_title",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Count orders where Item Description contains specific technical terms",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "item_description": {
              "$regex": "technical terms",
              "$options": "i"
            }
          }
        },
        {
          "$count": "order_count"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Show weekly patterns of CalCard vs non-CalCard purchases",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "week_number": {
              "$isoWeekYear": "$purchase_date"
            }
          }
        },
        {
          "$facet": {
            "calcard": [
              {
                "$match": {
                  "calcard": true
                }
              },
              {
                "$group": {
                  "_id": "$week_number",
                  "total": {
                    "$sum": "$total_price"
                  }
                }
              }
            ],
            "non_calcard": [
              {
                "$match": {
                  "calcard": false
                }
              },
              {
                "$group": {
                  "_id": "$week_number",
                  "total": {
                    "$sum": "$total_price"
                  }
                }
              }
            ]
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Show spending distribution by hour for each Supplier Qualification",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "supplier_qualifications": "$supplier_qualifications",
              "hour": {
                "$hour": "$purchase_date"
              }
            },
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.supplier_qualifications": 1,
            "_id.hour": 1
          }
        }
      ]
    },
    "result_count": 315
  },
  {
    "question": "Count orders where Item Description matches Item Name exactly",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "item_description": "$item_name"
          }
        },
        {
          "$count": "order_count"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List Item Names ordered only in first week of each month",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "week": {
              "$week": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "week": 1
          }
        },
        {
          "$sort": {
            "creation_date": 1
          }
        },
        {
          "$group": {
            "_id": null,
            "item_names": {
              "$push": "$item_name"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_names": 1
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Count orders where Classification Codes changed for same Item Name",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": {
              "item_name": "$item_name",
              "classification_code": "$classification_codes"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.item_name",
            "classification_code_count": {
              "$sum": 1
            },
            "total_count": {
              "$sum": "$count"
            }
          }
        },
        {
          "$match": {
            "classification_code_count": {
              "$gt": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": "$_id",
            "total_count": 1
          }
        }
      ]
    },
    "result_count": 28136
  },
  {
    "question": "List departments where all orders in a day share same Acquisition Method",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "purchase_date": "$purchase_date",
              "acquisition_method": "$acquisition_method"
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": {
              "department_name": "$_id.department_name",
              "purchase_date": "$_id.purchase_date"
            },
            "unique_methods": {
              "$sum": 1
            },
            "total_orders": {
              "$sum": "$order_count"
            }
          }
        },
        {
          "$match": {
            "unique_methods": 1,
            "total_orders": {
              "$gt": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "department_name": "$_id.department_name",
            "purchase_date": "$_id.purchase_date"
          }
        }
      ]
    },
    "result_count": 4938
  },
  {
    "question": "Show departments that never place orders on Mondays",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "department_name": 1,
            "day_of_week": {
              "$dayOfWeek": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "day_of_week": {
              "$ne": 2
            }
          }
        },
        {
          "$group": {
            "_id": "$department_name"
          }
        }
      ]
    },
    "result_count": 109
  },
  {
    "question": "Count orders where Unit Price is higher for smaller Quantities",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$sort": {
            "quantity": 1,
            "unit_price": -1
          }
        },
        {
          "$group": {
            "_id": null,
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Find Supplier Names that only appear in specific quarters",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "supplier_name": 1,
            "quarter": {
              "$concat": [
                {
                  "$substr": [
                    "$creation_date",
                    5,
                    2
                  ]
                },
                "Q"
              ]
            }
          }
        },
        {
          "$match": {
            "quarter": {
              "$in": [
                "01Q",
                "04Q"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name"
          }
        }
      ]
    },
    "result_count": 5309
  },
  {
    "question": "Show Purchase Order Numbers with items from exactly 4 different Segments",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": {
              "purchase_order_number": "$purchase_order_number",
              "segment": {
                "$substr": [
                  "$classification_codes",
                  0,
                  2
                ]
              }
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.purchase_order_number",
            "segment_count": {
              "$sum": 1
            },
            "segments": {
              "$addToSet": "$_id.segment"
            }
          }
        },
        {
          "$match": {
            "segment_count": 4
          }
        },
        {
          "$project": {
            "_id": 0,
            "purchase_order_number": "$_id",
            "segments": 1
          }
        }
      ]
    },
    "result_count": 1526
  },
  {
    "question": "Count orders where Creation Date is on weekend but Purchase Date isn't",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "creation_date_day_of_week": {
              "$dayOfWeek": "$creation_date"
            },
            "purchase_date_day_of_week": {
              "$dayOfWeek": "$purchase_date"
            }
          }
        },
        {
          "$match": {
            "creation_date_day_of_week": {
              "$in": [
                1,
                7
              ]
            },
            "purchase_date_day_of_week": {
              "$nin": [
                1,
                7
              ]
            }
          }
        },
        {
          "$count": "weekend_creation_weekday_purchase_count"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List Item Names ordered in pairs (same Quantity, same Purchase Date)",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$sort": {
            "quantity": 1,
            "purchase_date": 1,
            "item_name": 1
          }
        },
        {
          "$group": {
            "_id": {
              "quantity": "$quantity",
              "purchase_date": "$purchase_date"
            },
            "item_names": {
              "$push": "$item_name"
            }
          }
        },
        {
          "$unwind": "$item_names"
        },
        {
          "$group": {
            "_id": {
              "quantity": "$_id.quantity",
              "purchase_date": "$_id.purchase_date"
            },
            "paired_items": {
              "$push": "$item_names"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "paired_items": 1
          }
        }
      ]
    },
    "result_count": 32838
  },
  {
    "question": "Count distinct Supplier Codes where Total Price > 10000 in FY 2013-2014",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            },
            "total_price": {
              "$gt": 10000
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_code"
          }
        },
        {
          "$count": "distinct_suppliers"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Find Purchase Order Numbers where Quantity > 10 and CalCard = 'Yes'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "quantity": {
              "$gt": 10
            },
            "calcard": "Yes"
          }
        },
        {
          "$project": {
            "purchase_order_number": 1,
            "_id": 0
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Sum Total Price by Acquisition Method for each month in FY 2014-2015",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2014",
                "2015"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": {
              "month": {
                "$month": "$purchase_date"
              },
              "acquisition_method": "$acquisition_method"
            },
            "total_price": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Count orders where Supplier Qualifications contains 'SB' grouped by Department Name",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_qualifications": {
              "$regex": "SB"
            }
          }
        },
        {
          "$group": {
            "_id": "$department_name",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 105
  },
  {
    "question": "List all Item Names where Unit Price * Quantity differs from Total Price",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "$expr": {
              "$ne": [
                {
                  "$multiply": [
                    "$unit_price",
                    "$quantity"
                  ]
                },
                "$total_price"
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": 1
          }
        }
      ]
    },
    "result_count": 10372
  },
  {
    "question": "Show weekly order count where Classification Codes > 5000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": {
              "$elemMatch": {
                "$gt": "5000"
              }
            }
          }
        },
        {
          "$project": {
            "week": {
              "$week": "$purchase_date"
            },
            "year": {
              "$year": "$purchase_date"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "week": "$week",
              "year": "$year"
            },
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 543
  },
  {
    "question": "Count Purchase Order Numbers by Supplier Name where LPA Number is not null",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "lpa_number": {
              "$ne": null
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name",
            "purchase_order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 20538
  },
  {
    "question": "Show daily spending where Normalized UNSPSC between 1000 and 2000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "normalized_unspsc": {
              "$gte": 1000,
              "$lte": 2000
            }
          }
        },
        {
          "$group": {
            "_id": {
              "date": "$purchase_date",
              "unspsc": "$normalized_unspsc"
            },
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.date": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Count orders by Class Title where Total Price > department average",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "class_title": "$class_title",
              "department_name": "$department_name"
            },
            "total_price": {
              "$sum": "$total_price"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.department_name",
            "dept_avg": {
              "$avg": "$total_price"
            },
            "data": {
              "$push": {
                "class_title": "$_id.class_title",
                "total_price": "$total_price",
                "count": "$count"
              }
            }
          }
        },
        {
          "$unwind": "$data"
        },
        {
          "$match": {
            "data.total_price": {
              "$gt": "$dept_avg"
            }
          }
        },
        {
          "$group": {
            "_id": "$data.class_title",
            "count": {
              "$sum": "$data.count"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Sum Quantity by Commodity Title for each Department Name",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "department_name": "$department_name",
              "commodity_title": "$commodity_title"
            },
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        },
        {
          "$sort": {
            "_id.department_name": 1,
            "_id.commodity_title": 1
          }
        }
      ]
    },
    "result_count": 37782
  },
  {
    "question": "List Purchase Order Numbers where Segment = 43000000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "segment": "43000000"
          }
        },
        {
          "$project": {
            "purchase_order_number": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Count orders by Supplier Zip Code where Location = '95814'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": "95814"
          }
        },
        {
          "$group": {
            "_id": "$supplier_zip_code",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Show monthly spending where Family > 5000 and Class < 6000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "family": {
              "$gt": "5000"
            },
            "class": {
              "$lt": "6000"
            }
          }
        },
        {
          "$group": {
            "_id": {
              "year": {
                "$year": "$purchase_date"
              },
              "month": {
                "$month": "$purchase_date"
              }
            },
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.year": 1,
            "_id.month": 1
          }
        }
      ]
    },
    "result_count": 64
  },
  {
    "question": "Find orders where Unit Price is highest for each Item Name",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$sort": {
            "unit_price": -1
          }
        },
        {
          "$group": {
            "_id": "$item_name",
            "highest_unit_price": {
              "$first": "$unit_price"
            }
          }
        }
      ]
    },
    "result_count": 109151
  },
  {
    "question": "Count Purchase Order Numbers by hour of Creation Date",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "purchase_order_number": 1,
            "creation_hour": {
              "$hour": "$creation_date"
            }
          }
        },
        {
          "$group": {
            "_id": "$creation_hour",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Sum Total Price by Sub-Acquisition Type where Quantity > 1",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "quantity": {
              "$gt": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$sub_acquisition_type",
            "total_price": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 23
  },
  {
    "question": "Show daily order count where Supplier Code appears multiple times",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "supplier_code": "$supplier_code",
              "creation_date": {
                "$dateToString": {
                  "format": "%Y-%m-%d",
                  "date": "$creation_date"
                }
              }
            },
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "order_count": {
              "$gt": 1
            }
          }
        }
      ]
    },
    "result_count": 25457
  },
  {
    "question": "Find Purchase Order Numbers with same Creation Date and Purchase Date",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "creation_date": {
              "$eq": "$purchase_date"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "purchase_order_number": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Count orders by Class Title where Total Price exceeds $5000",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 5000
            }
          }
        },
        {
          "$group": {
            "_id": "$class_title",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 1916
  },
  {
    "question": "Sum weekly spending where Supplier Qualifications is not null",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_qualifications": {
              "$ne": null
            }
          }
        },
        {
          "$group": {
            "_id": {
              "week": {
                "$week": "$purchase_date"
              },
              "year": {
                "$year": "$purchase_date"
              }
            },
            "weekly_spend": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 591
  },
  {
    "question": "Show order count by Location where CalCard = 'No'",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "calcard": "No"
          }
        },
        {
          "$group": {
            "_id": "$location",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Which fiscal quarter recorded the highest total spending?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "year": {
              "$year": "$purchase_date"
            },
            "quarter": {
              "$ceil": {
                "$divide": [
                  {
                    "$add": [
                      1,
                      {
                        "$month": "$purchase_date"
                      }
                    ]
                  },
                  3
                ]
              }
            },
            "total_price": 1
          }
        },
        {
          "$group": {
            "_id": {
              "year": "$year",
              "quarter": "$quarter"
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all purchase orders where the total price exceeded $50,000.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 50000
            }
          }
        },
        {
          "$project": {
            "purchase_order_number": 1,
            "total_price": 1
          }
        }
      ]
    },
    "result_count": 21445
  },
  {
    "question": "Which locations had the highest spending in 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$location",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": -1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "How many unique suppliers were involved in procurement in 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name"
          }
        },
        {
          "$count": "unique_suppliers"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What was the total expenditure for classification code '76121504'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": "76121504"
          }
        },
        {
          "$group": {
            "_id": null,
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which item was ordered in the largest quantity in 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$sort": {
            "quantity": -1
          }
        },
        {
          "$limit": 1
        },
        {
          "$project": {
            "_id": 0,
            "item_name": 1,
            "quantity": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the total spending across all purchase orders in 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "How does the total spending vary across acquisition types?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_type",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": -1
          }
        }
      ]
    },
    "result_count": 5
  },
  {
    "question": "What is the average total price per purchase order?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$purchase_order_number",
            "total_order_price": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "average_total_price": {
              "$avg": "$total_order_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Identify the five most expensive purchase orders in the dataset.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$sort": {
            "total_price": -1
          }
        },
        {
          "$limit": 5
        },
        {
          "$project": {
            "_id": 0,
            "purchase_order_number": 1,
            "total_price": 1
          }
        }
      ]
    },
    "result_count": 5
  },
  {
    "question": "Which month had the highest spending in fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": {
              "month": {
                "$month": "$purchase_date"
              },
              "year": {
                "$year": "$purchase_date"
              }
            },
            "total_spent": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spent": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which department created the most purchase orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$department_name",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total expenditure for each supplier in the dataset?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 20538
  },
  {
    "question": "Which supplier had the most transactions in fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": "$supplier_name",
            "transaction_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "transaction_count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the average spending per supplier?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_spend_per_supplier": {
              "$avg": "$total_spend"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many suppliers were involved in purchases exceeding $10,000?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 10000
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name"
          }
        },
        {
          "$count": "num_suppliers"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which classification code had the highest spending in fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": "$classification_codes",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many unique classification codes are used in the dataset?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": null,
            "unique_codes": {
              "$addToSet": "$classification_codes"
            }
          }
        },
        {
          "$project": {
            "num_unique_codes": {
              "$size": "$unique_codes"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What are the top 3 most frequently used commodity titles?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$commodity_title",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        },
        {
          "$limit": 3
        }
      ]
    },
    "result_count": 3
  },
  {
    "question": "Which family of items contributed the most to total spending?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$family",
            "total_spent": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spent": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which location had the largest number of purchase orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$location",
            "num_purchase_orders": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "num_purchase_orders": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the average spending per location?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$location",
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_spend_per_location": {
              "$avg": "$total_spend"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Identify the top 3 zip codes with the highest total expenditure.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_zip_code",
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_expenditure": -1
          }
        },
        {
          "$limit": 3
        }
      ]
    },
    "result_count": 3
  },
  {
    "question": "What is the percentage of total spending for orders from suppliers located in California?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$regex": "^9"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "california_spending": {
              "$sum": "$total_price"
            },
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$project": {
            "california_spending_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$californiaSpending",
                    "$totalSpending"
                  ]
                },
                100
              ]
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the distribution of spending across sub-acquisition methods?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$sub_acquisition_method",
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spend": -1
          }
        }
      ]
    },
    "result_count": 17
  },
  {
    "question": "How many purchase orders were made using the 'WSCA/Coop' method?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "WSCA/Coop"
          }
        },
        {
          "$group": {
            "_id": null,
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which acquisition method accounted for the largest share of spending?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_method",
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spend": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What percentage of orders were made through 'Statewide Contract' acquisitions?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "Statewide Contract"
          }
        },
        {
          "$count": "statewide_contract_orders"
        },
        {
          "$addFields": {
            "total_orders": {
              "$sum": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$statewide_contract_orders",
                    "$total_orders"
                  ]
                },
                100
              ]
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which acquisition type had the lowest average spending per order?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_type",
            "avg_spending": {
              "$avg": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "avg_spending": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many purchase orders are missing a requisition number?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "requisition_number": {
              "$exists": false
            }
          }
        },
        {
          "$count": "missing_requisition_count"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What percentage of the dataset has missing classification codes?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": {
              "$exists": true,
              "$eq": []
            }
          }
        },
        {
          "$count": "missing_codes_count"
        },
        {
          "$addFields": {
            "total_count": {
              "$sum": 1
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "percentage_missing": {
              "$multiply": [
                {
                  "$divide": [
                    "$missing_codes_count",
                    "$total_count"
                  ]
                },
                100
              ]
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "How does spending differ between 'IT Goods' and 'NON-IT Goods'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$facet": {
            "it _goods": [
              {
                "$match": {
                  "commodity_title": {
                    "$regex": "IT",
                    "$options": "i"
                  }
                }
              },
              {
                "$group": {
                  "_id": null,
                  "total_spending": {
                    "$sum": "$total_price"
                  }
                }
              }
            ],
            "non-it _goods": [
              {
                "$match": {
                  "commodity_title": {
                    "$not": {
                      "$regex": "IT",
                      "$options": "i"
                    }
                  }
                }
              },
              {
                "$group": {
                  "_id": null,
                  "total_spending": {
                    "$sum": "$total_price"
                  }
                }
              }
            ]
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the distribution of acquisition types across fiscal years?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "fiscal_year": "$fiscal_year",
              "acquisition_type": "$acquisition_type"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.fiscal_year": 1,
            "_id.acquisition_type": 1
          }
        }
      ]
    },
    "result_count": 13
  },
  {
    "question": "What is the average total price for orders containing classification code '44103127'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": "44103127"
          }
        },
        {
          "$group": {
            "_id": null,
            "average_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which acquisition method had the highest total spending?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_method",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total price for all transactions where the total price exceeds $20,000?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 20000
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_price_over_20k": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the sum of unit prices for all items in the dataset?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": null,
            "total_unit_prices": {
              "$sum": "$unit_price"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "total_unit_prices": 1
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders had a unit price greater than $100?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "unit_price": {
              "$gt": 100
            }
          }
        },
        {
          "$count": "num_orders"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What percentage of total spending was contributed by 'IT Services'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "commodity_title": "IT Services"
          }
        },
        {
          "$group": {
            "_id": null,
            "it_services_total": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$lookup": {
            "from": "procurement_data",
            "pipeline": [
              {
                "$group": {
                  "_id": null,
                  "grand_total": {
                    "$sum": "$total_price"
                  }
                }
              }
            ],
            "as": "grandTotals"
          }
        },
        {
          "$unwind": "$grand_totals"
        },
        {
          "$addFields": {
            "percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$itServicesTotal",
                    "$grandTotals.grandTotal"
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "percentage": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Count the number of orders made by each supplier.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 20538
  },
  {
    "question": "What is the total spending for each supplier in the fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": "$supplier_name",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 11153
  },
  {
    "question": "Retrieve all records where the supplier zip code starts with '94'.",
    "query": {
      "find": {
        "supplier_zip_code": {
          "$regex": "^94"
        }
      }
    },
    "result_count": 0
  },
  {
    "question": "List all suppliers with at least 5 orders.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "order_count": {
              "$gte": 5
            }
          }
        }
      ]
    },
    "result_count": 3905
  },
  {
    "question": "Which supplier had the largest transaction by total price?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$sort": {
            "total_price": -1
          }
        },
        {
          "$limit": 1
        },
        {
          "$project": {
            "supplier_name": 1,
            "total_price": 1,
            "_id": 0
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all items with a classification code containing '7612'.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": {
              "$elemMatch": {
                "$regex": "7612"
              }
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": 1,
            "item_description": 1,
            "classification_codes": 1
          }
        }
      ]
    },
    "result_count": 3937
  },
  {
    "question": "What is the total quantity of items ordered for classification code '44103127'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": "44103127"
          }
        },
        {
          "$group": {
            "_id": null,
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which item name appears the most frequently in the dataset?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$item_name",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many unique items were ordered in fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": "$item_name",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_unique_items": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total expenditure for items grouped by commodity title?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$commodity_title",
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 11184
  },
  {
    "question": "How many orders were created in each month of fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$project": {
            "month": {
              "$month": "$creation_date"
            }
          }
        },
        {
          "$group": {
            "_id": "$month",
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 12
  },
  {
    "question": "What is the average spending per order for each month?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "year": {
                "$year": "$purchase_date"
              },
              "month": {
                "$month": "$purchase_date"
              }
            },
            "total_orders": {
              "$sum": 1
            },
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "month_year": {
              "$dateFromParts": {
                "year": "$_id.year",
                "month": "$_id.month"
              }
            },
            "avg_spend_per_order": {
              "$divide": [
                "$total_spend",
                "$total_orders"
              ]
            }
          }
        }
      ]
    },
    "result_count": 233
  },
  {
    "question": "Which acquisition type accounted for the highest average total price per order?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_type",
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "avg_total_price": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total spending for orders where the total price is between $5,000 and $10,000?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gte": 5000,
              "$lte": 10000
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders had a total price of exactly $0?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": 0
          }
        },
        {
          "$count": "zero_dollar_orders"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total unit price of all items ordered in 2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2014"
          }
        },
        {
          "$group": {
            "_id": null,
            "total_unit_price": {
              "$sum": "$unit_price"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What percentage of total spending is attributed to 'NON-IT Goods'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "item_description": {
              "$not": {
                "$regex": "/IT/i"
              }
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "non_it_total": {
              "$sum": "$total_price"
            },
            "grand_total": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "non_it_percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$nonITTotal",
                    "$grandTotal"
                  ]
                },
                100
              ]
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all suppliers that provided items classified under 'IT Services'.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": {
              "$in": [
                "/Services/Management and Business Professionals/Information Technology Services"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the average total price per supplier?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "total_purchases": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_total_price": {
              "$avg": "$total_purchases"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Retrieve all suppliers whose zip codes start with '958'.",
    "query": {
      "find": {
        "supplier_zip_code": {
          "$regex": "^958"
        }
      },
      "projection": {
        "_id": 0,
        "supplier_name": 1,
        "supplier_zip_code": 1
      }
    },
    "result_count": 0
  },
  {
    "question": "Which supplier had the smallest total spending across all orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many suppliers have provided goods or services more than 3 times?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "count": {
              "$gt": 3
            }
          }
        },
        {
          "$count": "num_suppliers"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which classification codes are associated with the highest number of transactions?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": "$classification_codes",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        }
      ]
    },
    "result_count": 14790
  },
  {
    "question": "List all items that have a unit price greater than $1,000.",
    "query": {
      "find": {
        "unit_price": {
          "$gt": 1000
        }
      },
      "projection": {
        "_id": 0,
        "item_name": 1,
        "item_description": 1,
        "unit_price": 1
      }
    },
    "result_count": 0
  },
  {
    "question": "How many unique classification codes are used for 'IT Goods'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "commodity_title": "IT Goods"
          }
        },
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": null,
            "unique_codes": {
              "$addToSet": "$classification_codes"
            }
          }
        },
        {
          "$project": {
            "num_unique_codes": {
              "$size": "$unique_codes"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the total expenditure for items grouped by class title?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$class_title",
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 2193
  },
  {
    "question": "Which classification code had the lowest average total price per order?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": "$classification_codes",
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "avg_total_price": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which acquisition method has the lowest total spending?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_method",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders used the 'Statewide Contract' acquisition method?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "Statewide Contract"
          }
        },
        {
          "$count": "order_count"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the average spending per order for 'WSCA/Coop' acquisitions?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "WSCA/Coop"
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_spending_per_order": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the distribution of acquisition types across fiscal years?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "fiscal_year": "$fiscal_year",
              "acquisition_type": "$acquisition_type"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.fiscal_year": 1,
            "_id.acquisition_type": 1
          }
        }
      ]
    },
    "result_count": 13
  },
  {
    "question": "Which location had the highest total spending?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$location",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spending": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the average spending per location?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$location",
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_spend_per_location": {
              "$avg": "$total_spend"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders were created at locations with coordinates starting with '38.'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": {
              "$regex": "^38"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all orders where the location field contains '91436'.",
    "query": {
      "find": {
        "location": {
          "$regex": "91436"
        }
      }
    },
    "result_count": 0
  },
  {
    "question": "What percentage of orders originated from locations with a zip code starting with '9'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$regex": "^9"
            }
          }
        },
        {
          "$count": "total_orders"
        },
        {
          "$addFields": {
            "total_orders": {
              "$sum": 1
            }
          }
        },
        {
          "$lookup": {
            "from": "procurement_data",
            "as": "all_orders",
            "pipeline": [
              {
                "$count": "count"
              }
            ]
          }
        },
        {
          "$addFields": {
            "percentage": {
              "$multiply": [
                {
                  "$divide": [
                    "$total_orders",
                    {
                      "$arrayElemAt": [
                        "$all_orders.count",
                        0
                      ]
                    }
                  ]
                },
                100
              ]
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "percentage": 1
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all orders created on Fridays.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "day_of_week": {
              "$dayOfWeek": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "day_of_week": 6
          }
        }
      ]
    },
    "result_count": 37975
  },
  {
    "question": "How many orders were created in each fiscal year?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$fiscal_year",
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id": 1
          }
        }
      ]
    },
    "result_count": 3
  },
  {
    "question": "Which purchase order has the highest total price?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$purchase_order_number",
            "total_price": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_price": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders have a quantity of 1 or less?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "quantity": {
              "$lte": 1
            }
          }
        },
        {
          "$count": "orders_with_quantity_1_or_less"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total expenditure for orders with a unit price greater than $500?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "unit_price": {
              "$gt": 500
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which orders have a total price between $1,000 and $5,000?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gte": 1000,
              "$lte": 5000
            }
          }
        }
      ]
    },
    "result_count": 33279
  },
  {
    "question": "List all suppliers with at least one order exceeding $50,000 in total price.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 50000
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name"
          }
        }
      ]
    },
    "result_count": 6008
  },
  {
    "question": "What is the average total price of orders for each supplier?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 20538
  },
  {
    "question": "Which supplier has provided the most unique items?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$item_name"
        },
        {
          "$group": {
            "_id": {
              "supplier_name": "$supplier_name",
              "item_name": "$item_name"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.supplier_name",
            "unique_items": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "unique_items": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders have been placed with suppliers that have 'ISO Certified' qualifications?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_qualifications": {
              "$regex": "ISO Certified",
              "$options": "i"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the total quantity of items supplied by each supplier?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        }
      ]
    },
    "result_count": 20538
  },
  {
    "question": "What is the total spending for all items under 'Office Supplies' classification?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "class_title": "Office Supplies"
          }
        },
        {
          "$group": {
            "_id": null,
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "List all orders where the classification codes include '1234'.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": "1234"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the average unit price of items classified under 'IT Equipment'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "segment_title": "IT Equipment"
          }
        },
        {
          "$group": {
            "_id": null,
            "average_unit_price": {
              "$avg": "$unit_price"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "How many unique classification codes are used in the dataset?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": null,
            "unique_codes": {
              "$addToSet": "$classification_codes"
            }
          }
        },
        {
          "$project": {
            "num_unique_codes": {
              "$size": "$unique_codes"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders were made using each acquisition method?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_method",
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 20
  },
  {
    "question": "What is the total spending for each acquisition method?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_method",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 20
  },
  {
    "question": "Which sub-acquisition type has the highest average total price?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$sub_acquisition_type",
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "avg_total_price": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total expenditure for 'Competitive Bidding' acquisitions?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "Competitive Bidding"
          }
        },
        {
          "$group": {
            "_id": null,
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Which acquisition type has the highest number of transactions?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_type",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all orders made from locations with coordinates in California (starting with '38.').",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": {
              "$regex": "^38\\."
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "lpa_number": 1,
            "purchase_order_number": 1,
            "requisition_number": 1,
            "location": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the total spending for orders originating from zip codes starting with '91'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$regex": "^91"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which location has the highest total quantity of items ordered?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$location",
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        },
        {
          "$sort": {
            "total_quantity": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders are missing a valid location entry?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": {
              "$exists": false
            }
          }
        },
        {
          "$count": "missing_location_count"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Retrieve all orders where the location includes the zip code '95814'.",
    "query": {
      "find": {
        "location": {
          "$regex": "95814"
        }
      }
    },
    "result_count": 0
  },
  {
    "question": "How many orders were created on each day of the week?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "day_of_week": {
              "$dayOfWeek": "$creation_date"
            }
          }
        },
        {
          "$group": {
            "_id": "$day_of_week",
            "count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 7
  },
  {
    "question": "What is the average total price of orders created on weekdays versus weekends?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "day_of_week": {
              "$dayOfWeek": "$creation_date"
            }
          }
        },
        {
          "$addFields": {
            "is_weekday": {
              "$in": [
                "$dayOfWeek",
                [
                  1,
                  2,
                  3,
                  4,
                  5
                ]
              ]
            }
          }
        },
        {
          "$group": {
            "_id": "$is_weekday",
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders were created in the first 15 days of each month?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "day_of_month": {
              "$dayOfMonth": "$creation_date"
            }
          }
        },
        {
          "$match": {
            "day_of_month": {
              "$lte": 15
            }
          }
        },
        {
          "$group": {
            "_id": {
              "month": {
                "$month": "$creation_date"
              },
              "year": {
                "$year": "$creation_date"
              }
            },
            "order_count": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 36
  },
  {
    "question": "Which month in fiscal year 2013-2014 had the least number of purchase orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": {
              "month": {
                "$month": "$purchase_date"
              }
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the range (difference between maximum and minimum) of total prices for all orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": null,
            "max_total_price": {
              "$max": "$total_price"
            },
            "min_total_price": {
              "$min": "$total_price"
            }
          }
        },
        {
          "$project": {
            "price_range": {
              "$subtract": [
                "$max_total_price",
                "$min_total_price"
              ]
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total expenditure for all orders with missing purchase dates?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "purchase_date": null
          }
        },
        {
          "$group": {
            "_id": null,
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all purchase orders with a total price less than the average total price.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": null,
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        },
        {
          "$unwind": "$total_price"
        },
        {
          "$match": {
            "total_price": {
              "$lt": "$avg_total_price"
            }
          }
        },
        {
          "$group": {
            "_id": "$purchase_order_number"
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the total quantity of items purchased where the total price exceeds $100,000?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$gt": 100000
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which supplier has the highest average unit price across all items?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "total_units": {
              "$sum": "$quantity"
            },
            "total_price": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$addFields": {
            "avg_unit_price": {
              "$divide": [
                "$total_price",
                "$total_units"
              ]
            }
          }
        },
        {
          "$sort": {
            "avg_unit_price": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many unique suppliers provided goods in fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": "$supplier_name"
          }
        },
        {
          "$count": "unique_suppliers"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all suppliers whose names contain the word 'Tech'.",
    "query": {
      "find": {
        "supplier_name": {
          "$regex": "Tech",
          "$options": "i"
        }
      },
      "projection": {
        "_id": 0,
        "supplier_name": 1
      }
    },
    "result_count": 0
  },
  {
    "question": "Which supplier has the lowest total expenditure for all their orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_expenditure": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders were placed with suppliers located in zip codes starting with '9'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$regex": "^9"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_orders": {
              "$sum": 1
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total quantity of items ordered for each classification code?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": "$classification_codes",
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        }
      ]
    },
    "result_count": 14790
  },
  {
    "question": "Retrieve all orders where the item name starts with 'Laptop'.",
    "query": {
      "find": {
        "item_name": {
          "$regex": "^Laptop"
        }
      }
    },
    "result_count": 0
  },
  {
    "question": "Which item had the highest total spending across all orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$item_name",
            "total_spent": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spent": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders have both classification codes and commodity titles missing?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "$and": [
              {
                "classification_codes": {
                  "$exists": false
                }
              },
              {
                "commodity_title": {
                  "$exists": false
                }
              }
            ]
          }
        },
        {
          "$count": "count"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the total expenditure for each acquisition type, grouped by fiscal year?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "fiscal_year": "$fiscal_year",
              "acquisition_type": "$acquisition_type"
            },
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "_id.fiscal_year": 1,
            "_id.acquisition_type": 1
          }
        }
      ]
    },
    "result_count": 13
  },
  {
    "question": "Which acquisition method has the highest average unit price for items?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_method",
            "avg_unit_price": {
              "$avg": "$unit_price"
            }
          }
        },
        {
          "$sort": {
            "avg_unit_price": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total number of transactions made using 'Informal Competitive' acquisition methods?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "Informal Competitive"
          }
        },
        {
          "$count": "total_transactions"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Retrieve all orders where the acquisition type includes 'IT'.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_type": {
              "$regex": "IT",
              "$options": "i"
            }
          }
        }
      ]
    },
    "result_count": 200000
  },
  {
    "question": "What is the average quantity of items ordered for each acquisition type?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_type",
            "avg_quantity": {
              "$avg": "$quantity"
            }
          }
        }
      ]
    },
    "result_count": 5
  },
  {
    "question": "What is the total expenditure for all orders made from zip codes starting with '914'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$regex": "^914"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all orders where the location coordinates contain negative longitude values.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location.coordinates": {
              "$elemMatch": {
                "$lt": 0
              }
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Which location had the largest number of orders classified under 'Furniture'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "segment_title": "Furniture"
          }
        },
        {
          "$group": {
            "_id": "$location",
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "order_count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the total quantity of items ordered from locations in the 95841 zip code?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": "95841"
          }
        },
        {
          "$group": {
            "_id": null,
            "total_quantity": {
              "$sum": "$quantity"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which item had the highest total spending within the classification code '76121504'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": "76121504"
          }
        },
        {
          "$group": {
            "_id": "$item_name",
            "total_spent": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_spent": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all orders where the total price is an exact multiple of the quantity ordered.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$addFields": {
            "is_multiple": {
              "$eq": [
                {
                  "$mod": [
                    "$total_price",
                    "$quantity"
                  ]
                },
                0
              ]
            }
          }
        },
        {
          "$match": {
            "is_multiple": true
          }
        }
      ]
    },
    "result_count": 82375
  },
  {
    "question": "What is the total expenditure for all orders where the unit price exceeds $10,000?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "unit_price": {
              "$gt": 10000
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which supplier has provided the greatest number of unique classification codes?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": "$supplier_name",
            "unique_codes": {
              "$addToSet": "$classification_codes"
            }
          }
        },
        {
          "$project": {
            "supplier_name": "$_id",
            "num_unique_codes": {
              "$size": "$unique_codes"
            }
          }
        },
        {
          "$sort": {
            "num_unique_codes": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many suppliers have handled orders with missing location information?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": {
              "$exists": false
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name"
          }
        },
        {
          "$count": "num_suppliers"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the average total price of all orders handled by the top 3 suppliers with the most transactions?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "total_transactions": {
              "$sum": 1
            },
            "total_price": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_transactions": -1
          }
        },
        {
          "$limit": 3
        },
        {
          "$group": {
            "_id": null,
            "average_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all classification codes with more than 50 transactions.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": "$classification_codes",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "count": {
              "$gt": 50
            }
          }
        }
      ]
    },
    "result_count": 1116
  },
  {
    "question": "Which family title has the highest total expenditure across all orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$family_title",
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$sort": {
            "total_expenditure": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders have items with a unit price below $5 but a total price above $100?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "unit_price": {
              "$lt": 5
            },
            "total_price": {
              "$gt": 100
            }
          }
        },
        {
          "$count": "num_orders"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the average quantity ordered for items classified under 'Furniture'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "segment_title": "Furniture"
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_quantity": {
              "$avg": "$quantity"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Which acquisition type has the most consistent (lowest variance) total price across orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$acquisition_type",
            "prices": {
              "$push": "$total_price"
            }
          }
        },
        {
          "$project": {
            "_id": 1,
            "variance": {
              "$stdDevPop": "$prices"
            }
          }
        },
        {
          "$sort": {
            "variance": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many orders used a combination of 'Direct Purchase' and 'WSCA/Coop' acquisition methods?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "Direct Purchase",
            "sub_acquisition_method": "WSCA/Coop"
          }
        },
        {
          "$count": "order_count"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Retrieve all records where the sub-acquisition method is missing but the acquisition type is 'IT Goods'.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_type": "IT Goods",
            "sub_acquisition_method": {
              "$exists": false
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the distribution of acquisition methods across different locations?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "location": "$location",
              "acquisition_method": "$acquisition_method"
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "_id.location": 1,
            "_id.acquisition_method": 1
          }
        }
      ]
    },
    "result_count": 9961
  },
  {
    "question": "Which sub-acquisition method has the highest average unit price for items?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$sub_acquisition_method",
            "avg_unit_price": {
              "$avg": "$unit_price"
            }
          }
        },
        {
          "$sort": {
            "avg_unit_price": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "How many locations have more than 10 orders in fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": "$location",
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "order_count": {
              "$gt": 10
            }
          }
        },
        {
          "$count": "num_locations"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total spending for orders grouped by zip codes in California?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$regex": "^9"
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_zip_code",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 2064
  },
  {
    "question": "How many orders are missing location coordinates but include zip codes?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": {
              "$exists": false
            },
            "supplier_zip_code": {
              "$exists": true
            }
          }
        },
        {
          "$count": "orders_missing_location"
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "Which fiscal year had the fewest orders created?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$fiscal_year",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": 1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What percentage of total orders were created in Q4 of each fiscal year?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$project": {
            "fiscal_year": 1,
            "creation_date": 1,
            "total_price": 1,
            "quarter": {
              "$cond": [
                {
                  "$and": [
                    {
                      "$gte": [
                        {
                          "$month": "$creation_date"
                        },
                        10
                      ]
                    },
                    {
                      "$lte": [
                        {
                          "$month": "$creation_date"
                        },
                        12
                      ]
                    }
                  ]
                },
                4,
                {
                  "$cond": [
                    {
                      "$and": [
                        {
                          "$gte": [
                            {
                              "$month": "$creation_date"
                            },
                            7
                          ]
                        },
                        {
                          "$lte": [
                            {
                              "$month": "$creation_date"
                            },
                            9
                          ]
                        }
                      ]
                    },
                    3,
                    {
                      "$cond": [
                        {
                          "$and": [
                            {
                              "$gte": [
                                {
                                  "$month": "$creation_date"
                                },
                                4
                              ]
                            },
                            {
                              "$lte": [
                                {
                                  "$month": "$creation_date"
                                },
                                6
                              ]
                            }
                          ]
                        },
                        2,
                        1
                      ]
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "$group": {
            "_id": {
              "fiscal_year": "$fiscal_year",
              "quarter": "$quarter"
            },
            "total_orders": {
              "$sum": 1
            },
            "total_spend": {
              "$sum": "$total_price"
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.fiscal_year",
            "quarterly_data": {
              "$push": {
                "quarter": "$_id.quarter",
                "total_orders": "$total_orders",
                "total_spend": "$total_spend"
              }
            },
            "overall_total": {
              "$sum": "$total_orders"
            }
          }
        },
        {
          "$project": {
            "fiscal_year": "$_id",
            "quarterly_data": {
              "$map": {
                "input": "$quarterly_data",
                "as": "data",
                "in": {
                  "quarter": "$$data.quarter",
                  "percentage_of_total": {
                    "$multiply": [
                      {
                        "$divide": [
                          "$$data.total_orders",
                          "$overall_total"
                        ]
                      },
                      100
                    ]
                  }
                }
              }
            },
            "_id": 0
          }
        }
      ]
    },
    "result_count": 3
  },
  {
    "question": "Which 10 purchase orders have the lowest unit prices?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$unwind": "$item_details"
        },
        {
          "$sort": {
            "item_details.unit_price": 1
          }
        },
        {
          "$limit": 10
        },
        {
          "$group": {
            "_id": "$purchase_order_number",
            "lowest_unit_prices": {
              "$push": {
                "item_name": "$item_details.item_name",
                "unit_price": "$item_details.unit_price"
              }
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "How many orders have a total price less than $500 but a unit price greater than $50?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$lt": 500
            },
            "unit_price": {
              "$gt": 50
            }
          }
        },
        {
          "$count": "num_orders"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which orders have a total price exactly equal to their quantity multiplied by $100?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "total_price": {
              "$eq": {
                "$multiply": [
                  "$quantity",
                  100
                ]
              }
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the standard deviation of total prices for all orders in 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$in": [
                "2013",
                "2014"
              ]
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "prices": {
              "$push": "$total_price"
            }
          }
        },
        {
          "$project": {
            "_id": 0,
            "std_dev_total_price": {
              "$stdDevPop": "$prices"
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "How many suppliers have only one transaction in the entire dataset?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "transaction_count": {
              "$sum": 1
            }
          }
        },
        {
          "$match": {
            "transaction_count": 1
          }
        },
        {
          "$count": "suppliers_with_one_transaction"
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the maximum total price for a single order from each supplier?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$supplier_name",
            "max_total_price": {
              "$max": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 20538
  },
  {
    "question": "Retrieve all suppliers who provided only 'NON-IT Goods' during the fiscal year.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": {
              "$exists": true
            },
            "item_description": {
              "$not": {
                "$regex": "/IT/i"
              }
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_name"
          }
        }
      ]
    },
    "result_count": 20538
  },
  {
    "question": "Which classification codes have the most items with quantities exceeding 10?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "quantity": {
              "$gt": 10
            }
          }
        },
        {
          "$unwind": "$classification_codes"
        },
        {
          "$group": {
            "_id": "$classification_codes",
            "item_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "item_count": -1
          }
        }
      ]
    },
    "result_count": 6356
  },
  {
    "question": "Which commodity title is associated with the highest number of orders?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": "$commodity_title",
            "order_count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "order_count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "List all items where the classification code and commodity title are both missing.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "$and": [
              {
                "classification_codes": {
                  "$exists": false
                }
              },
              {
                "commodity_title": {
                  "$exists": false
                }
              }
            ]
          }
        },
        {
          "$project": {
            "_id": 0,
            "item_name": 1,
            "item_description": 1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the maximum quantity ordered for any single item in fiscal year 2013-2014?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "fiscal_year": "2013-2014"
          }
        },
        {
          "$group": {
            "_id": "$item_name",
            "max_quantity": {
              "$max": "$quantity"
            }
          }
        },
        {
          "$sort": {
            "max_quantity": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which acquisition method has the most missing sub-acquisition types?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$group": {
            "_id": {
              "acquisition_method": "$acquisition_method",
              "sub_acquisition_method": {
                "$cond": [
                  {
                    "$eq": [
                      "$sub_acquisition_method",
                      null
                    ]
                  },
                  "MISSING",
                  "$sub_acquisition_method"
                ]
              }
            },
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$group": {
            "_id": "$_id.acquisition_method",
            "missing_count": {
              "$sum": {
                "$cond": [
                  {
                    "$eq": [
                      "$_id.sub_acquisition_method",
                      "MISSING"
                    ]
                  },
                  "$count",
                  0
                ]
              }
            },
            "total_count": {
              "$sum": "$count"
            }
          }
        },
        {
          "$sort": {
            "missing_count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "What is the total spending for 'Statewide Contract' acquisition methods grouped by fiscal year?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "Statewide Contract"
          }
        },
        {
          "$group": {
            "_id": "$fiscal_year",
            "total_spending": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 3
  },
  {
    "question": "Which acquisition type has the most items with quantities exceeding 100?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "quantity": {
              "$gt": 100
            }
          }
        },
        {
          "$group": {
            "_id": "$acquisition_type",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        },
        {
          "$limit": 1
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Retrieve all orders where the acquisition method is 'Direct Purchase' and the total price exceeds $50,000.",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "acquisition_method": "Direct Purchase",
            "total_price": {
              "$gt": 50000
            }
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the average total price of orders originating from zip codes starting with '9'?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "supplier_zip_code": {
              "$regex": "^9"
            }
          }
        },
        {
          "$group": {
            "_id": null,
            "avg_total_price": {
              "$avg": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 1
  },
  {
    "question": "Which zip codes had the highest number of missing classification codes?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "classification_codes": {
              "$exists": true,
              "$size": 0
            }
          }
        },
        {
          "$group": {
            "_id": "$supplier_zip_code",
            "count": {
              "$sum": 1
            }
          }
        },
        {
          "$sort": {
            "count": -1
          }
        }
      ]
    },
    "result_count": 0
  },
  {
    "question": "What is the total expenditure for each location with valid coordinates?",
    "query": {
      "aggregate": true,
      "pipeline": [
        {
          "$match": {
            "location": {
              "$exists": true,
              "$ne": null
            }
          }
        },
        {
          "$group": {
            "_id": "$location",
            "total_expenditure": {
              "$sum": "$total_price"
            }
          }
        }
      ]
    },
    "result_count": 3435
  }
]