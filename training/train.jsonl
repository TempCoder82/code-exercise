{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What are the top 3 most frequently used commodity titles?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$commodity_title\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    },\n    {\n      \"$limit\": 3\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List total spending by day of week for each Acquisition Method"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"acquisition_method\": \"$acquisition_method\",\n          \"day_of_week\": {\n            \"$dayOfWeek\": \"$purchase_date\"\n          }\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.acquisition_method\": 1,\n        \"_id.day_of_week\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Identify the top 3 zip codes with the highest total expenditure."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_zip_code\",\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_expenditure\": -1\n      }\n    },\n    {\n      \"$limit\": 3\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the weekly order volume (count of Purchase Order Numbers) trend for FY 2013-2014"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"purchase_order_number\": 1,\n        \"week\": {\n          \"$week\": \"$purchase_date\"\n        },\n        \"year\": {\n          \"$year\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"week\": \"$week\",\n          \"year\": \"$year\"\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.year\": 1,\n        \"_id.week\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many purchase orders were created each month by the Department of Technology in FY 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\",\n        \"department_name\": \"Department of Technology\"\n      }\n    },\n    {\n      \"$project\": {\n        \"month\": {\n          \"$month\": \"$creation_date\"\n        },\n        \"purchase_order_number\": 1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"month\": \"$month\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders where Classification Codes changed for same Item Name"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"item_name\": \"$item_name\",\n          \"classification_code\": \"$classification_codes\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.item_name\",\n        \"classification_code_count\": {\n          \"$sum\": 1\n        },\n        \"total_count\": {\n          \"$sum\": \"$count\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"classification_code_count\": {\n          \"$gt\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": \"$_id\",\n        \"total_count\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition type has the highest number of transactions?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_type\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which sub-acquisition type has the highest average total price?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$sub_acquisition_type\",\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"avg_total_price\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which location had the highest total spending?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the distribution of Total Price by Classification Codes for IT-related purchases"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"item_description\": {\n          \"$regex\": \"IT\",\n          \"$options\": \"i\"\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$classification_codes\",\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders had a unit price greater than $100?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"unit_price\": {\n          \"$gt\": 100\n        }\n      }\n    },\n    {\n      \"$count\": \"num_orders\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the pattern of high-value orders (>$100,000) by day of week and time of day"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 100000\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"day_of_week\": {\n          \"$dayOfWeek\": \"$creation_date\"\n        },\n        \"hour_of_day\": {\n          \"$hour\": \"$creation_date\"\n        },\n        \"total_price\": 1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"day_of_week\": \"$day_of_week\",\n          \"hour_of_day\": \"$hour_of_day\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        },\n        \"total_value\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.day_of_week\": 1,\n        \"_id.hour_of_day\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average total price of orders for each supplier?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders used a combination of 'Direct Purchase' and 'WSCA/Coop' acquisition methods?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"Direct Purchase\",\n        \"sub_acquisition_method\": \"WSCA/Coop\"\n      }\n    },\n    {\n      \"$count\": \"order_count\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all items where the classification code and commodity title are both missing."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"$and\": [\n          {\n            \"classification_codes\": {\n              \"$exists\": false\n            }\n          },\n          {\n            \"commodity_title\": {\n              \"$exists\": false\n            }\n          }\n        ]\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": 1,\n        \"item_description\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders were made using each acquisition method?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_method\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all orders where the location coordinates contain negative longitude values."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location.coordinates\": {\n          \"$elemMatch\": {\n            \"$lt\": 0\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show Item Names ordered at same Unit Price across all Departments"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"item_name\": \"$item_name\",\n          \"unit_price\": \"$unit_price\"\n        },\n        \"departments\": {\n          \"$addToSet\": \"$department_name\"\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$departments\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id\",\n        \"num_departments\": {\n          \"$sum\": 1\n        },\n        \"departments\": {\n          \"$push\": \"$departments\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"num_departments\": {\n          \"$gt\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": \"$_id.item_name\",\n        \"unit_price\": \"$_id.unit_price\",\n        \"departments\": 1\n      }\n    },\n    {\n      \"$sort\": {\n        \"item_name\": 1,\n        \"unit_price\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Sub-Acquisition Method for each Department Name"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"sub_acquisition_method\": \"$sub_acquisition_method\"\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.department_name\": 1,\n        \"_id.sub_acquisition_method\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Item Names that were purchased using every Sub-Acquisition Method available in the database"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$sub_acquisition_method\",\n        \"item_names\": {\n          \"$addToSet\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$item_names\"\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"all_item_names\": {\n          \"$addToSet\": \"$item_names\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all orders where the total price is an exact multiple of the quantity ordered."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"is_multiple\": {\n          \"$eq\": [\n            {\n              \"$mod\": [\n                \"$total_price\",\n                \"$quantity\"\n              ]\n            },\n            0\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"is_multiple\": true\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find Purchase Order Numbers where Quantity > 10 and CalCard = 'Yes'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"quantity\": {\n          \"$gt\": 10\n        },\n        \"calcard\": \"Yes\"\n      }\n    },\n    {\n      \"$project\": {\n        \"purchase_order_number\": 1,\n        \"_id\": 0\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show count of orders by Supplier Name where CalCard is 'No'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"calcard\": \"No\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders were placed with suppliers located in zip codes starting with '9'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$regex\": \"^9\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_orders\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many unique classification codes are used in the dataset?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"unique_codes\": {\n          \"$addToSet\": \"$classification_codes\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"num_unique_codes\": {\n          \"$size\": \"$unique_codes\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many unique suppliers were involved in procurement in 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\"\n      }\n    },\n    {\n      \"$count\": \"unique_suppliers\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all suppliers that provided items classified under 'IT Services'."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": {\n          \"$in\": [\n            \"/Services/Management and Business Professionals/Information Technology Services\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How does the total spending vary across acquisition types?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_type\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the percentage of Total Price spent through each Acquisition Type by Location '95814'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": \"95814\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"acquisition_type\": \"$acquisition_type\"\n        },\n        \"total_price_sum\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"acquisition_types\": {\n          \"$push\": {\n            \"acquisition_type\": \"$_id.acquisition_type\",\n            \"total_price_sum\": \"$total_price_sum\"\n          }\n        },\n        \"grand_total\": {\n          \"$sum\": \"$total_price_sum\"\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$acquisition_types\"\n    },\n    {\n      \"$addFields\": {\n        \"acquisition_types.percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$acquisition_types.total_price_sum\",\n                \"$grand_total\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"acquisition_type_percentages\": {\n          \"$push\": \"$acquisition_types\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How does the use of CalCard vary across different Acquisition Methods?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"acquisition_method\": \"$acquisition_method\",\n          \"calcard\": \"$calcard\"\n        },\n        \"total_purchases\": {\n          \"$sum\": \"$total_price\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.acquisition_method\": 1,\n        \"_id.calcard\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which supplier has the highest average unit price across all items?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_units\": {\n          \"$sum\": \"$quantity\"\n        },\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"avg_unit_price\": {\n          \"$divide\": [\n            \"$total_price\",\n            \"$total_units\"\n          ]\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"avg_unit_price\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for orders with a unit price greater than $500?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"unit_price\": {\n          \"$gt\": 500\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which 10 purchase orders have the lowest unit prices?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$item_details\"\n    },\n    {\n      \"$sort\": {\n        \"item_details.unit_price\": 1\n      }\n    },\n    {\n      \"$limit\": 10\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$purchase_order_number\",\n        \"lowest_unit_prices\": {\n          \"$push\": {\n            \"item_name\": \"$item_details.item_name\",\n            \"unit_price\": \"$item_details.unit_price\"\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many suppliers were involved in purchases exceeding $10,000?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 10000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\"\n      }\n    },\n    {\n      \"$count\": \"num_suppliers\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all Item Names where Unit Price is above $1000 in the Education department"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"department_name\": \"Education\",\n        \"unit_price\": {\n          \"$gt\": 1000\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all Item Names purchased by more than 3 different departments in a single month"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"item_name\": \"$item_name\",\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          },\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          }\n        },\n        \"departments\": {\n          \"$addToSet\": \"$department_name\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"departments.length\": {\n          \"$gt\": 3\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": \"$_id.item_name\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Compare the average Quantity ordered between CalCard and non-CalCard purchases within each Class Title."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"class_title\": \"$class_title\",\n          \"calcard\": \"$calcard\"\n        },\n        \"avg_quantity\": {\n          \"$avg\": \"$quantity\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.class_title\": 1,\n        \"_id.calcard\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List departments with highest percentage of single-item Purchase Order Numbers"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"purchase_order_number\": \"$purchase_order_number\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.department_name\",\n        \"total_pos\": {\n          \"$sum\": 1\n        },\n        \"single_item_pos\": {\n          \"$sum\": {\n            \"$cond\": [\n              {\n                \"$eq\": [\n                  \"$count\",\n                  1\n                ]\n              },\n              1,\n              0\n            ]\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"department_name\": \"$_id\",\n        \"single_item_po_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$single_item_pos\",\n                \"$total_pos\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"single_item_po_percentage\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of purchases in each Family Title are processed through CalCard?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"calcard\": true\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$family_title\",\n        \"calcard_total\": {\n          \"$sum\": \"$total_price\"\n        },\n        \"total\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 1,\n        \"calcard_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$calcard_total\",\n                \"$total\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of orders were made through 'Statewide Contract' acquisitions?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"Statewide Contract\"\n      }\n    },\n    {\n      \"$count\": \"statewide_contract_orders\"\n    },\n    {\n      \"$addFields\": {\n        \"total_orders\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$statewide_contract_orders\",\n                \"$total_orders\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which purchase order has the highest total price?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$purchase_order_number\",\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_price\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all items with a classification code containing '7612'."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": {\n          \"$elemMatch\": {\n            \"$regex\": \"7612\"\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": 1,\n        \"item_description\": 1,\n        \"classification_codes\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Retrieve all records where the sub-acquisition method is missing but the acquisition type is 'IT Goods'."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_type\": \"IT Goods\",\n        \"sub_acquisition_method\": {\n          \"$exists\": false\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all orders where the location field contains '91436'."}, {"role": "assistant", "content": "{\n  \"find\": {\n    \"location\": {\n      \"$regex\": \"91436\"\n    }\n  }\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show total monthly spending where Supplier Qualification includes 'SB'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_qualifications\": {\n          \"$regex\": \"SB\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          },\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.year\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average total price of orders created on weekdays versus weekends?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"day_of_week\": {\n          \"$dayOfWeek\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"is_weekday\": {\n          \"$in\": [\n            \"$dayOfWeek\",\n            [\n              1,\n              2,\n              3,\n              4,\n              5\n            ]\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$is_weekday\",\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all Item Names where Unit Price * Quantity differs from Total Price"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"$expr\": {\n          \"$ne\": [\n            {\n              \"$multiply\": [\n                \"$unit_price\",\n                \"$quantity\"\n              ]\n            },\n            \"$total_price\"\n          ]\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all classification codes with more than 50 transactions."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$classification_codes\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"count\": {\n          \"$gt\": 50\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition type accounted for the highest average total price per order?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_type\",\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"avg_total_price\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders where Supplier Qualifications contains 'SB' grouped by Department Name"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_qualifications\": {\n          \"$regex\": \"SB\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the relationship between Supplier Zip Code distances and Total Price within each Acquisition Type?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"acquisition_type\": \"$acquisition_type\",\n          \"supplier_zip_code\": \"$supplier_zip_code\"\n        },\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.acquisition_type\": 1,\n        \"total_price\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition type has the most items with quantities exceeding 100?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"quantity\": {\n          \"$gt\": 100\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_type\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average total price of all orders handled by the top 3 suppliers with the most transactions?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_transactions\": {\n          \"$sum\": 1\n        },\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_transactions\": -1\n      }\n    },\n    {\n      \"$limit\": 3\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"average_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Class Title for each Department Name"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"class_title\": \"$class_title\"\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.department_name\": 1,\n        \"_id.class_title\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show all Supplier Names who received orders from at least 5 different Locations in a single month"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$location\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_name\": \"$supplier_name\",\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          },\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          }\n        },\n        \"locations\": {\n          \"$addToSet\": \"$location\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"locations.length\": {\n          \"$gte\": 5\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.supplier_name\",\n        \"months\": {\n          \"$push\": {\n            \"month\": \"$_id.month\",\n            \"year\": \"$_id.year\",\n            \"locations\": \"$locations\"\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many locations have more than 10 orders in fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"order_count\": {\n          \"$gt\": 10\n        }\n      }\n    },\n    {\n      \"$count\": \"num_locations\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders where Item Description matches Item Name exactly"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"item_description\": \"$item_name\"\n      }\n    },\n    {\n      \"$count\": \"order_count\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders were created in each fiscal year?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$fiscal_year\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which supplier has provided the most unique items?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$item_name\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_name\": \"$supplier_name\",\n          \"item_name\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.supplier_name\",\n        \"unique_items\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"unique_items\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total spending for 'Statewide Contract' acquisition methods grouped by fiscal year?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"Statewide Contract\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$fiscal_year\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total spending for orders where the total price is between $5,000 and $10,000?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gte\": 5000,\n          \"$lte\": 10000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find Purchase Order Numbers with same Creation Date and Purchase Date"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"creation_date\": {\n          \"$eq\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"purchase_order_number\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show Department Names where more than 50% of their purchases have matching LPA Numbers"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"total_purchases\": {\n          \"$sum\": 1\n        },\n        \"matching_lpa_purchases\": {\n          \"$sum\": {\n            \"$cond\": [\n              {\n                \"$ne\": [\n                  \"$lpa_number\",\n                  null\n                ]\n              },\n              1,\n              0\n            ]\n          }\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"$expr\": {\n          \"$gt\": [\n            {\n              \"$divide\": [\n                \"$matching_lpa_purchases\",\n                \"$total_purchases\"\n              ]\n            },\n            0.5\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which month had the highest spending in fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          },\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          }\n        },\n        \"total_spent\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spent\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which month in fiscal year 2013-2014 had the least number of purchase orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which Department Names have the highest percentage of weekend order creation?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"is_weekend\": {\n          \"$cond\": {\n            \"if\": {\n              \"$in\": [\n                {\n                  \"$dayOfWeek\": \"$creation_date\"\n                },\n                [\n                  1,\n                  7\n                ]\n              ]\n            },\n            \"then\": true,\n            \"else\": false\n          }\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"is_weekend\": true\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"weekend_count\": {\n          \"$sum\": 1\n        },\n        \"total_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"weekend_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$weekendCount\",\n                \"$totalCount\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"weekend_percentage\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "For each Department Name, what is the ratio of unique Supplier Codes to total purchase orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\"\n        },\n        \"unique_suppliers\": {\n          \"$addToSet\": \"$supplier_code\"\n        },\n        \"total_pos\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"department_name\": \"$_id.department_name\",\n        \"supplier_po_ratio\": {\n          \"$divide\": [\n            {\n              \"$size\": \"$unique_suppliers\"\n            },\n            \"$total_pos\"\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the hourly pattern of order creation (Creation Date) during business hours"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"creation_date\": 1,\n        \"hour\": {\n          \"$hour\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"hour\": {\n          \"$gte\": 8,\n          \"$lte\": 17\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$hour\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders where Creation Date and Purchase Date match"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"creation_date\": 1,\n        \"purchase_date\": 1,\n        \"match\": {\n          \"$eq\": [\n            \"$creation_date\",\n            \"$purchase_date\"\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"match\": true\n      }\n    },\n    {\n      \"$count\": \"matching_orders\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which classification codes are associated with the highest number of transactions?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$classification_codes\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total spending across all purchase orders in 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of total orders were created in the last 5 days of each month?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"day_of_month\": {\n          \"$dayOfMonth\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"day_of_month\": {\n          \"$gte\": 26\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_orders\": {\n          \"$sum\": 1\n        },\n        \"orders_in_last_five_days\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"percentage_in_last_five_days\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$ordersInLastFiveDays\",\n                \"$totalOrders\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"percentage_in_last_five_days\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which family title has the highest total expenditure across all orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$family_title\",\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_expenditure\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the sum of unit prices for all items in the dataset?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_unit_prices\": {\n          \"$sum\": \"$unit_price\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"total_unit_prices\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show me the number of unique Supplier Codes used by each Department Name in FY 2014-2015"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2014\",\n            \"2015\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"supplier_code\": \"$supplier_code\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.department_name\",\n        \"unique_supplier_codes\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many suppliers have handled orders with missing location information?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": {\n          \"$exists\": false\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\"\n      }\n    },\n    {\n      \"$count\": \"num_suppliers\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average total price of orders originating from zip codes starting with '9'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$regex\": \"^9\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders were created at locations with coordinates starting with '38.'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": {\n          \"$regex\": \"^38\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of total orders (Purchase Order Numbers) were created between 3-5 PM?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"purchase_order_number\": 1,\n        \"creation_hour\": {\n          \"$hour\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"creation_hour\": {\n          \"$gte\": 15,\n          \"$lte\": 17\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_orders\": {\n          \"$sum\": 1\n        },\n        \"orders_3pm_5pm\": {\n          \"$sum\": {\n            \"$cond\": [\n              {\n                \"$and\": [\n                  {\n                    \"$gte\": [\n                      \"$creation_hour\",\n                      15\n                    ]\n                  },\n                  {\n                    \"$lte\": [\n                      \"$creation_hour\",\n                      17\n                    ]\n                  }\n                ]\n              },\n              1,\n              0\n            ]\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$orders_3pm_5pm\",\n                \"$total_orders\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition method has the highest average unit price for items?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_method\",\n        \"avg_unit_price\": {\n          \"$avg\": \"$unit_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"avg_unit_price\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What's the average number of unique Item Names ordered per week by Location?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"week_number\": {\n          \"$week\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"week_number\": \"$week_number\",\n          \"location\": \"$location\"\n        },\n        \"unique_item_names\": {\n          \"$addToSet\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"week_number\": \"$_id.week_number\",\n        \"location\": \"$_id.location\",\n        \"num_unique_item_names\": {\n          \"$size\": \"$unique_item_names\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"avg_unique_item_names\": {\n          \"$avg\": \"$num_unique_item_names\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders are missing a valid location entry?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": {\n          \"$exists\": false\n        }\n      }\n    },\n    {\n      \"$count\": \"missing_location_count\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of total spending was contributed by 'IT Services'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"commodity_title\": \"IT Services\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"it_services_total\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$lookup\": {\n        \"from\": \"procurement_data\",\n        \"pipeline\": [\n          {\n            \"$group\": {\n              \"_id\": null,\n              \"grand_total\": {\n                \"$sum\": \"$total_price\"\n              }\n            }\n          }\n        ],\n        \"as\": \"grandTotals\"\n      }\n    },\n    {\n      \"$unwind\": \"$grand_totals\"\n    },\n    {\n      \"$addFields\": {\n        \"percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$itServicesTotal\",\n                \"$grandTotals.grandTotal\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"percentage\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count Purchase Order Numbers by hour of Creation Date"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"purchase_order_number\": 1,\n        \"creation_hour\": {\n          \"$hour\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$creation_hour\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which location has the highest total quantity of items ordered?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_quantity\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Supplier Names with most diverse range of Item Names supplied"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$item_name\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_name\": \"$supplier_name\",\n          \"item_name\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.supplier_name\",\n        \"unique_items\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"unique_items\": -1\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"supplier_name\": \"$_id\",\n        \"unique_items\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all orders created on Fridays."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"day_of_week\": {\n          \"$dayOfWeek\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"day_of_week\": 6\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average order value by Sub-Acquisition Method for each Department Name?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"sub_acquisition_method\": \"$sub_acquisition_method\"\n        },\n        \"total_order_value\": {\n          \"$sum\": \"$total_price\"\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"average_order_value\": {\n          \"$divide\": [\n            \"$total_order_value\",\n            \"$order_count\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.department_name\",\n        \"sub_acquisition_methods\": {\n          \"$push\": {\n            \"sub_acquisition_method\": \"$_id.sub_acquisition_method\",\n            \"average_order_value\": \"$average_order_value\"\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What's the average number of unique Supplier Names used per month by each Department Name?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"month\": {\n            \"$month\": \"$creation_date\"\n          },\n          \"year\": {\n            \"$year\": \"$creation_date\"\n          },\n          \"department_name\": \"$department_name\"\n        },\n        \"unique_suppliers\": {\n          \"$addToSet\": \"$supplier_name\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"month\": \"$_id.month\",\n        \"year\": \"$_id.year\",\n        \"department_name\": \"$_id.department_name\",\n        \"num_unique_suppliers\": {\n          \"$size\": \"$unique_suppliers\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"avg_unique_suppliers\": {\n          \"$avg\": \"$num_unique_suppliers\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition method accounted for the largest share of spending?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_method\",\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spend\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which locations had the highest spending in 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average spending per order for each month?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          },\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        },\n        \"total_orders\": {\n          \"$sum\": 1\n        },\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"month_year\": {\n          \"$dateFromParts\": {\n            \"year\": \"$_id.year\",\n            \"month\": \"$_id.month\"\n          }\n        },\n        \"avg_spend_per_order\": {\n          \"$divide\": [\n            \"$total_spend\",\n            \"$total_orders\"\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Item Names with highest percentage of rush orders (same day Creation and Purchase Date)"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"is_rush_order\": {\n          \"$eq\": [\n            \"$creation_date\",\n            \"$purchase_date\"\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"is_rush_order\": true\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"total_rush_orders\": {\n          \"$sum\": 1\n        },\n        \"total_orders\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"rush_order_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$totalRushOrders\",\n                \"$totalOrders\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"rush_order_percentage\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Retrieve all suppliers whose zip codes start with '958'."}, {"role": "assistant", "content": "{\n  \"find\": {\n    \"supplier_zip_code\": {\n      \"$regex\": \"^958\"\n    }\n  },\n  \"projection\": {\n    \"_id\": 0,\n    \"supplier_name\": 1,\n    \"supplier_zip_code\": 1\n  }\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Compare the average Total Price between different Supplier Qualification categories."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_qualifications\",\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all items that have a unit price greater than $1,000."}, {"role": "assistant", "content": "{\n  \"find\": {\n    \"unit_price\": {\n      \"$gt\": 1000\n    }\n  },\n  \"projection\": {\n    \"_id\": 0,\n    \"item_name\": 1,\n    \"item_description\": 1,\n    \"unit_price\": 1\n  }\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders were created in the first 15 days of each month?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"day_of_month\": {\n          \"$dayOfMonth\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"day_of_month\": {\n          \"$lte\": 15\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"month\": {\n            \"$month\": \"$creation_date\"\n          },\n          \"year\": {\n            \"$year\": \"$creation_date\"\n          }\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of high-value purchases (>$50,000) have matching LPA Numbers across different departments?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 50000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"lpa_number\": \"$lpa_number\",\n          \"department_name\": \"$department_name\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.lpa_number\",\n        \"departments\": {\n          \"$push\": \"$_id.department_name\"\n        },\n        \"total_count\": {\n          \"$sum\": \"$count\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"departments.1\": {\n          \"$exists\": true\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                {\n                  \"$size\": {\n                    \"$filter\": {\n                      \"input\": \"$departments\",\n                      \"cond\": {\n                        \"$gt\": [\n                          {\n                            \"$strLenCP\": \"$$this\"\n                          },\n                          0\n                        ]\n                      }\n                    }\n                  }\n                },\n                {\n                  \"$size\": \"$departments\"\n                }\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_percentage\": {\n          \"$avg\": \"$percentage\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show daily order count where Supplier Code appears multiple times"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_code\": \"$supplier_code\",\n          \"creation_date\": {\n            \"$dateToString\": {\n              \"format\": \"%Y-%m-%d\",\n              \"date\": \"$creation_date\"\n            }\n          }\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"order_count\": {\n          \"$gt\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show monthly spending patterns for each Normalized UNSPSC category"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"month\": {\n          \"$month\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"normalized_unspsc\": \"$normalized_unspsc\",\n          \"month\": \"$month\"\n        },\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.normalized_unspsc\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Supplier Qualification for each Location"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"location\": \"$location\",\n          \"supplier_qualifications\": \"$supplier_qualifications\"\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.location\": 1,\n        \"_id.supplier_qualifications\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which family of items contributed the most to total spending?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$family\",\n        \"total_spent\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spent\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What's the ratio of rush orders (Purchase Date same as Creation Date) by Department Name?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"is_rush_order\": {\n          \"$cmp\": [\n            \"$creation_date\",\n            \"$purchase_date\"\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"is_rush_order\": 0\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"total_orders\": {\n          \"$sum\": 1\n        },\n        \"rush_orders\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"rush_order_ratio\": {\n          \"$divide\": [\n            \"$rush_orders\",\n            \"$total_orders\"\n          ]\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 1,\n        \"rush_order_ratio\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many suppliers have provided goods or services more than 3 times?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"count\": {\n          \"$gt\": 3\n        }\n      }\n    },\n    {\n      \"$count\": \"num_suppliers\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders were created on each day of the week?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"day_of_week\": {\n          \"$dayOfWeek\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$day_of_week\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total spending for each acquisition method?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_method\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average spending per location?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_spend_per_location\": {\n          \"$avg\": \"$total_spend\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all purchase orders with a total price less than the average total price."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$total_price\"\n    },\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$lt\": \"$avg_total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$purchase_order_number\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show me all Item Names purchased through both 'WSCA/Coop' and 'Leveraged Procurement Agreement' Acquisition Methods"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": {\n          \"$in\": [\n            \"WSCA/Coop\",\n            \"Leveraged Procurement Agreement\"\n          ]\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which commodity title is associated with the highest number of orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$commodity_title\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"order_count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for each location with valid coordinates?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": {\n          \"$exists\": true,\n          \"$ne\": null\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Purchase Order Numbers where all items were ordered from the same Supplier Code"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"purchase_order_number\": \"$purchase_order_number\",\n          \"supplier_code\": \"$supplier_code\"\n        },\n        \"item_count\": {\n          \"$sum\": 1\n        },\n        \"unique_suppliers\": {\n          \"$addToSet\": \"$supplier_code\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"unique_suppliers\": {\n          \"$size\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"purchase_order_number\": \"$_id.purchase_order_number\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Retrieve all records where the supplier zip code starts with '94'."}, {"role": "assistant", "content": "{\n  \"find\": {\n    \"supplier_zip_code\": {\n      \"$regex\": \"^94\"\n    }\n  }\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which supplier has provided the greatest number of unique classification codes?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"unique_codes\": {\n          \"$addToSet\": \"$classification_codes\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"supplier_name\": \"$_id\",\n        \"num_unique_codes\": {\n          \"$size\": \"$unique_codes\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"num_unique_codes\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which sub-acquisition method has the highest average unit price for items?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$sub_acquisition_method\",\n        \"avg_unit_price\": {\n          \"$avg\": \"$unit_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"avg_unit_price\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Location where Total Price is above $10000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 10000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many unique suppliers provided goods in fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\"\n      }\n    },\n    {\n      \"$count\": \"unique_suppliers\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which fiscal quarter recorded the highest total spending?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"year\": {\n          \"$year\": \"$purchase_date\"\n        },\n        \"quarter\": {\n          \"$ceil\": {\n            \"$divide\": [\n              {\n                \"$add\": [\n                  1,\n                  {\n                    \"$month\": \"$purchase_date\"\n                  }\n                ]\n              },\n              3\n            ]\n          }\n        },\n        \"total_price\": 1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": \"$year\",\n          \"quarter\": \"$quarter\"\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum Quantity by Item Name for Department of Technology"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"department_name\": \"Department of Technology\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average Total Price of purchases by Acquisition Method where LPA Number is not null?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"lpa_number\": {\n          \"$ne\": null\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_method\",\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all Item Names ordered by both Location '95814' and '95605'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": {\n          \"$in\": [\n            \"95814\",\n            \"95605\"\n          ]\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"location\": 1,\n        \"item_name\": 1\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": 1,\n        \"location\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find Item Names where average Quantity per order exceeds 50"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"avg_quantity\": {\n          \"$avg\": \"$quantity\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"avg_quantity\": {\n          \"$gt\": 50\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Normalized UNSPSC where Total Price exceeds $1000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 1000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$normalized_unspsc\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for all orders made from zip codes starting with '914'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$regex\": \"^914\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total spending for all items under 'Office Supplies' classification?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"class_title\": \"Office Supplies\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for 'Competitive Bidding' acquisitions?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"Competitive Bidding\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List departments where all orders in a day share same Acquisition Method"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"purchase_date\": \"$purchase_date\",\n          \"acquisition_method\": \"$acquisition_method\"\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$_id.department_name\",\n          \"purchase_date\": \"$_id.purchase_date\"\n        },\n        \"unique_methods\": {\n          \"$sum\": 1\n        },\n        \"total_orders\": {\n          \"$sum\": \"$order_count\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"unique_methods\": 1,\n        \"total_orders\": {\n          \"$gt\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"department_name\": \"$_id.department_name\",\n        \"purchase_date\": \"$_id.purchase_date\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of the dataset has missing classification codes?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": {\n          \"$exists\": true,\n          \"$eq\": []\n        }\n      }\n    },\n    {\n      \"$count\": \"missing_codes_count\"\n    },\n    {\n      \"$addFields\": {\n        \"total_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"percentage_missing\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$missing_codes_count\",\n                \"$total_count\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average total price per purchase order?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$purchase_order_number\",\n        \"total_order_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"average_total_price\": {\n          \"$avg\": \"$total_order_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show all Department Names where CalCard purchases account for more than 25% of their total order count"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"calcard\": true\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"calcard_count\": {\n          \"$sum\": 1\n        },\n        \"total_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"calcard_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$calcard_count\",\n                \"$total_count\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"calcard_percentage\": {\n          \"$gt\": 25\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Item Names ordered only in first week of each month"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"week\": {\n          \"$week\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"week\": 1\n      }\n    },\n    {\n      \"$sort\": {\n        \"creation_date\": 1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"item_names\": {\n          \"$push\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_names\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum Total Price by Acquisition Method for each month in FY 2014-2015"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2014\",\n            \"2015\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          },\n          \"acquisition_method\": \"$acquisition_method\"\n        },\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List departments that spent more than $50,000 in a single day, including the Purchase Date"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"purchase_date\": \"$purchase_date\"\n        },\n        \"total_spent\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"total_spent\": {\n          \"$gt\": 50000\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"department_name\": \"$_id.department_name\",\n        \"purchase_date\": \"$_id.purchase_date\",\n        \"total_spent\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the distribution of Supplier Qualifications within each Family across different fiscal years?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"family\": \"$family\",\n          \"supplier_qualifications\": \"$supplier_qualifications\",\n          \"fiscal_year\": \"$fiscal_year\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.family\": 1,\n        \"_id.supplier_qualifications\": 1,\n        \"_id.fiscal_year\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show departments that never place orders on Mondays"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"department_name\": 1,\n        \"day_of_week\": {\n          \"$dayOfWeek\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"day_of_week\": {\n          \"$ne\": 2\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What was the total spending by Location for purchases with Supplier Qualification 'SB'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_qualifications\": \"SB\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all suppliers who had more than 5 orders with the same Item Name in a single month"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$item_name\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_name\": \"$supplier_name\",\n          \"item_name\": \"$item_name\",\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          },\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          }\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"count\": {\n          \"$gt\": 5\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.supplier_name\",\n        \"items\": {\n          \"$push\": {\n            \"item_name\": \"$_id.item_name\",\n            \"month\": \"$_id.month\",\n            \"year\": \"$_id.year\",\n            \"count\": \"$count\"\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum Quantity by Commodity Title for each Department Name"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"commodity_title\": \"$commodity_title\"\n        },\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.department_name\": 1,\n        \"_id.commodity_title\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of orders originated from locations with a zip code starting with '9'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$regex\": \"^9\"\n        }\n      }\n    },\n    {\n      \"$count\": \"total_orders\"\n    },\n    {\n      \"$addFields\": {\n        \"total_orders\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$lookup\": {\n        \"from\": \"procurement_data\",\n        \"as\": \"all_orders\",\n        \"pipeline\": [\n          {\n            \"$count\": \"count\"\n          }\n        ]\n      }\n    },\n    {\n      \"$addFields\": {\n        \"percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$total_orders\",\n                {\n                  \"$arrayElemAt\": [\n                    \"$all_orders.count\",\n                    0\n                  ]\n                }\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"percentage\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show departments where more than 30% of their orders were created on Fridays"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"total_orders\": {\n          \"$sum\": 1\n        },\n        \"friday_orders\": {\n          \"$sum\": {\n            \"$cond\": [\n              {\n                \"$eq\": [\n                  {\n                    \"$dayOfWeek\": \"$creation_date\"\n                  },\n                  6\n                ]\n              },\n              1,\n              0\n            ]\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 1,\n        \"friday_order_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$friday_orders\",\n                \"$total_orders\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"friday_order_percentage\": {\n          \"$gt\": 30\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show total spending (Total Price) by week for Location '95814'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": \"95814\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"week\": {\n            \"$week\": \"$purchase_date\"\n          },\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          }\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.year\": 1,\n        \"_id.week\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Retrieve all orders where the acquisition type includes 'IT'."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_type\": {\n          \"$regex\": \"IT\",\n          \"$options\": \"i\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all orders made from locations with coordinates in California (starting with '38.')."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": {\n          \"$regex\": \"^38\\\\.\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"lpa_number\": 1,\n        \"purchase_order_number\": 1,\n        \"requisition_number\": 1,\n        \"location\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How does the Unit Price vary within each Segment Title across different fiscal years?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"segment_title\": \"$segment_title\",\n          \"fiscal_year\": \"$fiscal_year\"\n        },\n        \"unit_prices\": {\n          \"$push\": \"$unit_price\"\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"unit_price_stats\": {\n          \"$let\": {\n            \"vars\": {\n              \"prices\": \"$unit_prices\"\n            },\n            \"in\": {\n              \"min\": {\n                \"$min\": \"$$prices\"\n              },\n              \"max\": {\n                \"$max\": \"$$prices\"\n              },\n              \"avg\": {\n                \"$avg\": \"$$prices\"\n              }\n            }\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 1,\n        \"unit_price_stats\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Retrieve all orders where the acquisition method is 'Direct Purchase' and the total price exceeds $50,000."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"Direct Purchase\",\n        \"total_price\": {\n          \"$gt\": 50000\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find all orders where Unit Price multiplied by Quantity is over $5000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"calculated_total\": {\n          \"$multiply\": [\n            \"$unit_price\",\n            \"$quantity\"\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"calculated_total\": {\n          \"$gt\": 5000\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average total price for orders containing classification code '44103127'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": \"44103127\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"average_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How does spending differ between 'IT Goods' and 'NON-IT Goods'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$facet\": {\n        \"it _goods\": [\n          {\n            \"$match\": {\n              \"commodity_title\": {\n                \"$regex\": \"IT\",\n                \"$options\": \"i\"\n              }\n            }\n          },\n          {\n            \"$group\": {\n              \"_id\": null,\n              \"total_spending\": {\n                \"$sum\": \"$total_price\"\n              }\n            }\n          }\n        ],\n        \"non-it _goods\": [\n          {\n            \"$match\": {\n              \"commodity_title\": {\n                \"$not\": {\n                  \"$regex\": \"IT\",\n                  \"$options\": \"i\"\n                }\n              }\n            }\n          },\n          {\n            \"$group\": {\n              \"_id\": null,\n              \"total_spending\": {\n                \"$sum\": \"$total_price\"\n              }\n            }\n          }\n        ]\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Class Title where Total Price > department average"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"class_title\": \"$class_title\",\n          \"department_name\": \"$department_name\"\n        },\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.department_name\",\n        \"dept_avg\": {\n          \"$avg\": \"$total_price\"\n        },\n        \"data\": {\n          \"$push\": {\n            \"class_title\": \"$_id.class_title\",\n            \"total_price\": \"$total_price\",\n            \"count\": \"$count\"\n          }\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$data\"\n    },\n    {\n      \"$match\": {\n        \"data.total_price\": {\n          \"$gt\": \"$dept_avg\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$data.class_title\",\n        \"count\": {\n          \"$sum\": \"$data.count\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all orders where the classification codes include '1234'."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": \"1234\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum daily spending by Sub-Acquisition Method"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"sub_acquisition_method\": \"$sub_acquisition_method\",\n          \"date\": \"$creation_date\"\n        },\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.sub_acquisition_method\",\n        \"daily_spending\": {\n          \"$push\": {\n            \"date\": \"$_id.date\",\n            \"total_spend\": \"$total_spend\"\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for each acquisition type, grouped by fiscal year?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"fiscal_year\": \"$fiscal_year\",\n          \"acquisition_type\": \"$acquisition_type\"\n        },\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.fiscal_year\": 1,\n        \"_id.acquisition_type\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average number of line items per Purchase Order Number by Department Name?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$item_name\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"purchase_order_number\": \"$purchase_order_number\",\n          \"department_name\": \"$department_name\"\n        },\n        \"line_item_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.department_name\",\n        \"avg_line_items\": {\n          \"$avg\": \"$line_item_count\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which item was ordered in the largest quantity in 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"quantity\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": 1,\n        \"quantity\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show Purchase Order Numbers where all items have identical Creation Date and Purchase Date"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"purchase_order_number\": \"$purchase_order_number\",\n          \"creation_date\": \"$creation_date\",\n          \"purchase_date\": \"$purchase_date\"\n        },\n        \"distinct_dates\": {\n          \"$addToSet\": {\n            \"creation_date\": \"$creation_date\",\n            \"purchase_date\": \"$purchase_date\"\n          }\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"distinct_dates.creation_date\": {\n          \"$size\": 1\n        },\n        \"distinct_dates.purchase_date\": {\n          \"$size\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id.purchase_order_number\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the total monthly spending by Department Name where Supplier Zip Code starts with '956'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$regex\": \"^956\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.department_name\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Item Names ordered in pairs (same Quantity, same Purchase Date)"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$sort\": {\n        \"quantity\": 1,\n        \"purchase_date\": 1,\n        \"item_name\": 1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"quantity\": \"$quantity\",\n          \"purchase_date\": \"$purchase_date\"\n        },\n        \"item_names\": {\n          \"$push\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$item_names\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"quantity\": \"$_id.quantity\",\n          \"purchase_date\": \"$_id.purchase_date\"\n        },\n        \"paired_items\": {\n          \"$push\": \"$item_names\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"paired_items\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the monthly trend of average Unit Price for each Segment where Total Price exceeds $10,000?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 10000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"segment\": \"$segment\",\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        },\n        \"avg_unit_price\": {\n          \"$avg\": \"$unit_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.segment\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders where Creation Date is on weekend but Purchase Date isn't"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"creation_date_day_of_week\": {\n          \"$dayOfWeek\": \"$creation_date\"\n        },\n        \"purchase_date_day_of_week\": {\n          \"$dayOfWeek\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"creation_date_day_of_week\": {\n          \"$in\": [\n            1,\n            7\n          ]\n        },\n        \"purchase_date_day_of_week\": {\n          \"$nin\": [\n            1,\n            7\n          ]\n        }\n      }\n    },\n    {\n      \"$count\": \"weekend_creation_weekday_purchase_count\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for items grouped by commodity title?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$commodity_title\",\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What's the relationship between Supplier Qualifications and average Total Price across departments?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"supplier_qualifications\": \"$supplier_qualifications\"\n        },\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.department_name\": 1,\n        \"_id.supplier_qualifications\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total quantity of items ordered for each classification code?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$classification_codes\",\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total spending for orders grouped by zip codes in California?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$regex\": \"^9\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_zip_code\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the standard deviation of total prices for all orders in 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"prices\": {\n          \"$push\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"std_dev_total_price\": {\n          \"$stdDevPop\": \"$prices\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What's the distribution of order values (Total Price) by hour for each Acquisition Method?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"order_hour\": {\n          \"$hour\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"acquisition_method\": \"$acquisition_method\",\n          \"hour\": \"$order_hour\"\n        },\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.acquisition_method\": 1,\n        \"_id.hour\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many unique classification codes are used in the dataset?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"unique_codes\": {\n          \"$addToSet\": \"$classification_codes\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"num_unique_codes\": {\n          \"$size\": \"$unique_codes\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count Purchase Order Numbers by day of week for each Department Name"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"department_name\": 1,\n        \"purchase_order_number\": 1,\n        \"day_of_week\": {\n          \"$dayOfWeek\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"day_of_week\": \"$day_of_week\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.department_name\": 1,\n        \"_id.day_of_week\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average total price per supplier?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_purchases\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_total_price\": {\n          \"$avg\": \"$total_purchases\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders used the 'Statewide Contract' acquisition method?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"Statewide Contract\"\n      }\n    },\n    {\n      \"$count\": \"order_count\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders were created in each month of fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$project\": {\n        \"month\": {\n          \"$month\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$month\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find all purchases where the Total Price doesn't match Quantity multiplied by Unit Price"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"$expr\": {\n          \"$not\": {\n            \"$eq\": [\n              \"$total_price\",\n              {\n                \"$multiply\": [\n                  \"$quantity\",\n                  \"$unit_price\"\n                ]\n              }\n            ]\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What's the correlation between Classification Codes and Unit Price for IT Goods?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"item_description\": {\n          \"$regex\": \"IT\",\n          \"$options\": \"i\"\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"classification_code\": \"$classification_codes\",\n          \"unit_price\": \"$unit_price\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.unit_price\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Supplier Zip Code where Location = '95814'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": \"95814\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_zip_code\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What's the typical order value (Total Price) by day of week for each Department Name?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"day_of_week\": {\n          \"$dayOfWeek\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"day_of_week\": \"$day_of_week\"\n        },\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.department_name\": 1,\n        \"_id.day_of_week\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which location had the largest number of orders classified under 'Furniture'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"segment_title\": \"Furniture\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"order_count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all suppliers whose names contain the word 'Tech'."}, {"role": "assistant", "content": "{\n  \"find\": {\n    \"supplier_name\": {\n      \"$regex\": \"Tech\",\n      \"$options\": \"i\"\n    }\n  },\n  \"projection\": {\n    \"_id\": 0,\n    \"supplier_name\": 1\n  }\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many purchase orders are missing a requisition number?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"requisition_number\": {\n          \"$exists\": false\n        }\n      }\n    },\n    {\n      \"$count\": \"missing_requisition_count\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total quantity of items supplied by each supplier?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders have both classification codes and commodity titles missing?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"$and\": [\n          {\n            \"classification_codes\": {\n              \"$exists\": false\n            }\n          },\n          {\n            \"commodity_title\": {\n              \"$exists\": false\n            }\n          }\n        ]\n      }\n    },\n    {\n      \"$count\": \"count\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition method has the lowest total spending?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_method\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all purchase orders where the total price exceeded $50,000."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 50000\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"purchase_order_number\": 1,\n        \"total_price\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find Supplier Names that exclusively serve single Department Name"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_name\": \"$supplier_name\",\n          \"department_name\": \"$department_name\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.supplier_name\",\n        \"departments\": {\n          \"$push\": \"$_id.department_name\"\n        },\n        \"total_count\": {\n          \"$sum\": \"$count\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"departments\": {\n          \"$size\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"supplier_name\": \"$_id\",\n        \"departments\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total spending for orders originating from zip codes starting with '91'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$regex\": \"^91\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which supplier has the lowest total expenditure for all their orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_expenditure\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Identify the five most expensive purchase orders in the dataset."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$sort\": {\n        \"total_price\": -1\n      }\n    },\n    {\n      \"$limit\": 5\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"purchase_order_number\": 1,\n        \"total_price\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Department Names where more than 30% of their Total Price is spent with suppliers having Supplier Qualification 'DVBE'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_qualifications\": \"DVBE\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        },\n        \"dvbe_spend\": {\n          \"$sum\": {\n            \"$cond\": [\n              {\n                \"$eq\": [\n                  \"$supplier_qualifications\",\n                  \"DVBE\"\n                ]\n              },\n              \"$total_price\",\n              0\n            ]\n          }\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"dvbe_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$dvbe_spend\",\n                \"$total_price\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"dvbe_percentage\": {\n          \"$gt\": 30\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which Supplier Name had the highest number of orders under $1000 with CalCard 'Yes'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$lt\": 1000\n        },\n        \"calcard\": \"Yes\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"order_count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which zip codes had the highest number of missing classification codes?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": {\n          \"$exists\": true,\n          \"$size\": 0\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_zip_code\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Retrieve all orders where the item name starts with 'Laptop'."}, {"role": "assistant", "content": "{\n  \"find\": {\n    \"item_name\": {\n      \"$regex\": \"^Laptop\"\n    }\n  }\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find Supplier Names that only appear in specific quarters"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"supplier_name\": 1,\n        \"quarter\": {\n          \"$concat\": [\n            {\n              \"$substr\": [\n                \"$creation_date\",\n                5,\n                2\n              ]\n            },\n            \"Q\"\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"quarter\": {\n          \"$in\": [\n            \"01Q\",\n            \"04Q\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count distinct Supplier Codes where Total Price > 10000 in FY 2013-2014"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        },\n        \"total_price\": {\n          \"$gt\": 10000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_code\"\n      }\n    },\n    {\n      \"$count\": \"distinct_suppliers\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders had a total price of exactly $0?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": 0\n      }\n    },\n    {\n      \"$count\": \"zero_dollar_orders\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which orders have a total price between $1,000 and $5,000?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gte\": 1000,\n          \"$lte\": 5000\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show total spending by day where Supplier Qualification is 'DVBE'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_qualifications\": \"DVBE\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"day\": {\n            \"$dayOfMonth\": \"$purchase_date\"\n          },\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          },\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          }\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.year\": 1,\n        \"_id.month\": 1,\n        \"_id.day\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average spending per order for 'WSCA/Coop' acquisitions?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"WSCA/Coop\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_spending_per_order\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which item name appears the most frequently in the dataset?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Purchase Order Numbers where all items are from same Family Title"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"purchase_order_number\": \"$purchase_order_number\",\n          \"family_title\": \"$family_title\"\n        },\n        \"item_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.purchase_order_number\",\n        \"family_titles\": {\n          \"$addToSet\": \"$_id.family_title\"\n        },\n        \"total_items\": {\n          \"$sum\": \"$item_count\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"family_titles\": {\n          \"$size\": 1\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"purchase_order_number\": \"$_id\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum weekly spending where Supplier Qualifications is not null"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_qualifications\": {\n          \"$ne\": null\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"week\": {\n            \"$week\": \"$purchase_date\"\n          },\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          }\n        },\n        \"weekly_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total spending for each supplier in the fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total unit price of all items ordered in 2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_unit_price\": {\n          \"$sum\": \"$unit_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show daily spending where Normalized UNSPSC between 1000 and 2000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"normalized_unspsc\": {\n          \"$gte\": 1000,\n          \"$lte\": 2000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"date\": \"$purchase_date\",\n          \"unspsc\": \"$normalized_unspsc\"\n        },\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.date\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find orders where Unit Price is highest for each Item Name"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$sort\": {\n        \"unit_price\": -1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"highest_unit_price\": {\n          \"$first\": \"$unit_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count the number of orders made by each supplier."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average quantity of items ordered for each acquisition type?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_type\",\n        \"avg_quantity\": {\n          \"$avg\": \"$quantity\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which item had the highest total spending across all orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"total_spent\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spent\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which Department Name shows the most consistent daily order volume?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"creation_date\": {\n            \"$dateToString\": {\n              \"format\": \"%Y-%m-%d\",\n              \"date\": \"$creation_date\"\n            }\n          }\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.department_name\",\n        \"daily_orders\": {\n          \"$push\": {\n            \"date\": \"$_id.creation_date\",\n            \"count\": \"$order_count\"\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"department_name\": \"$_id\",\n        \"daily_order_stdev\": {\n          \"$stdDevPop\": \"$daily_orders.count\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"daily_order_stdev\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show me all Department Names where the average time between Creation Date and Purchase Date exceeds 14 days"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"time_diff\": {\n          \"$divide\": [\n            {\n              \"$subtract\": [\n                \"$purchase_date\",\n                \"$creation_date\"\n              ]\n            },\n            86400000\n          ]\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"time_diff\": {\n          \"$gt\": 14\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders where Item Description contains specific technical terms"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"item_description\": {\n          \"$regex\": \"technical terms\",\n          \"$options\": \"i\"\n        }\n      }\n    },\n    {\n      \"$count\": \"order_count\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which supplier had the most transactions in fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"transaction_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"transaction_count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which fiscal year had the fewest orders created?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$fiscal_year\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show Purchase Order Numbers with items from exactly 4 different Segments"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"purchase_order_number\": \"$purchase_order_number\",\n          \"segment\": {\n            \"$substr\": [\n              \"$classification_codes\",\n              0,\n              2\n            ]\n          }\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.purchase_order_number\",\n        \"segment_count\": {\n          \"$sum\": 1\n        },\n        \"segments\": {\n          \"$addToSet\": \"$_id.segment\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"segment_count\": 4\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"purchase_order_number\": \"$_id\",\n        \"segments\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which classification code had the highest spending in fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$classification_codes\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of total orders were created in Q4 of each fiscal year?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"fiscal_year\": 1,\n        \"creation_date\": 1,\n        \"total_price\": 1,\n        \"quarter\": {\n          \"$cond\": [\n            {\n              \"$and\": [\n                {\n                  \"$gte\": [\n                    {\n                      \"$month\": \"$creation_date\"\n                    },\n                    10\n                  ]\n                },\n                {\n                  \"$lte\": [\n                    {\n                      \"$month\": \"$creation_date\"\n                    },\n                    12\n                  ]\n                }\n              ]\n            },\n            4,\n            {\n              \"$cond\": [\n                {\n                  \"$and\": [\n                    {\n                      \"$gte\": [\n                        {\n                          \"$month\": \"$creation_date\"\n                        },\n                        7\n                      ]\n                    },\n                    {\n                      \"$lte\": [\n                        {\n                          \"$month\": \"$creation_date\"\n                        },\n                        9\n                      ]\n                    }\n                  ]\n                },\n                3,\n                {\n                  \"$cond\": [\n                    {\n                      \"$and\": [\n                        {\n                          \"$gte\": [\n                            {\n                              \"$month\": \"$creation_date\"\n                            },\n                            4\n                          ]\n                        },\n                        {\n                          \"$lte\": [\n                            {\n                              \"$month\": \"$creation_date\"\n                            },\n                            6\n                          ]\n                        }\n                      ]\n                    },\n                    2,\n                    1\n                  ]\n                }\n              ]\n            }\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"fiscal_year\": \"$fiscal_year\",\n          \"quarter\": \"$quarter\"\n        },\n        \"total_orders\": {\n          \"$sum\": 1\n        },\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.fiscal_year\",\n        \"quarterly_data\": {\n          \"$push\": {\n            \"quarter\": \"$_id.quarter\",\n            \"total_orders\": \"$total_orders\",\n            \"total_spend\": \"$total_spend\"\n          }\n        },\n        \"overall_total\": {\n          \"$sum\": \"$total_orders\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"fiscal_year\": \"$_id\",\n        \"quarterly_data\": {\n          \"$map\": {\n            \"input\": \"$quarterly_data\",\n            \"as\": \"data\",\n            \"in\": {\n              \"quarter\": \"$$data.quarter\",\n              \"percentage_of_total\": {\n                \"$multiply\": [\n                  {\n                    \"$divide\": [\n                      \"$$data.total_orders\",\n                      \"$overall_total\"\n                    ]\n                  },\n                  100\n                ]\n              }\n            }\n          }\n        },\n        \"_id\": 0\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the distribution of acquisition types across fiscal years?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"fiscal_year\": \"$fiscal_year\",\n          \"acquisition_type\": \"$acquisition_type\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.fiscal_year\": 1,\n        \"_id.acquisition_type\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which item had the highest total spending within the classification code '76121504'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": \"76121504\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"total_spent\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spent\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum Total Price by Sub-Acquisition Type where Quantity > 1"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"quantity\": {\n          \"$gt\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$sub_acquisition_type\",\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the monthly trend of new Supplier Codes being used for the first time"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": {\n            \"$year\": \"$creation_date\"\n          },\n          \"month\": {\n            \"$month\": \"$creation_date\"\n          }\n        },\n        \"new_supplier_codes\": {\n          \"$addToSet\": \"$supplier_code\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"year\": \"$_id.year\",\n        \"month\": \"$_id.month\",\n        \"new_supplier_codes_count\": {\n          \"$size\": \"$new_supplier_codes\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"year\": 1,\n        \"month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Retrieve all suppliers who provided only 'NON-IT Goods' during the fiscal year."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$exists\": true\n        },\n        \"item_description\": {\n          \"$not\": {\n            \"$regex\": \"/IT/i\"\n          }\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Retrieve all orders where the location includes the zip code '95814'."}, {"role": "assistant", "content": "{\n  \"find\": {\n    \"location\": {\n      \"$regex\": \"95814\"\n    }\n  }\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show order count by Family for IT-related purchases"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"item_description\": {\n          \"$regex\": \"IT\",\n          \"$options\": \"i\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$family_title\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Item Names ordered more than 5 times by Department of Health"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"department_name\": \"Department of Health\"\n      }\n    },\n    {\n      \"$unwind\": \"$item_name\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"count\": {\n          \"$gt\": 5\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of total spending is attributed to 'NON-IT Goods'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"item_description\": {\n          \"$not\": {\n            \"$regex\": \"/IT/i\"\n          }\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"non_it_total\": {\n          \"$sum\": \"$total_price\"\n        },\n        \"grand_total\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"non_it_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$nonITTotal\",\n                \"$grandTotal\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the distribution of Sub-Acquisition Methods within each Segment Title across fiscal years?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"segment_title\": \"$segment_title\",\n          \"sub_acquisition_method\": \"$sub_acquisition_method\",\n          \"fiscal_year\": \"$fiscal_year\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.segment_title\": 1,\n        \"_id.sub_acquisition_method\": 1,\n        \"_id.fiscal_year\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which supplier had the smallest total spending across all orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the number of Purchase Order Numbers created on the first business day of each month"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"creation_date_day\": {\n          \"$dayOfMonth\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"creation_date_day\": 1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": {\n            \"$year\": \"$creation_date\"\n          },\n          \"month\": {\n            \"$month\": \"$creation_date\"\n          }\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the seasonal pattern of Quantity ordered for each Family Title?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"family_title\": \"$family_title\",\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        },\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.family_title\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many unique items were ordered in fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_unique_items\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total quantity of items ordered for classification code '44103127'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": \"44103127\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for items grouped by class title?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$class_title\",\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the range (difference between maximum and minimum) of total prices for all orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"max_total_price\": {\n          \"$max\": \"$total_price\"\n        },\n        \"min_total_price\": {\n          \"$min\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"price_range\": {\n          \"$subtract\": [\n            \"$max_total_price\",\n            \"$min_total_price\"\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the distribution of spending across sub-acquisition methods?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$sub_acquisition_method\",\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spend\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List the top 10 months by total number of unique Item Names ordered"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"month\": {\n          \"$dateToString\": {\n            \"format\": \"%Y-%m\",\n            \"date\": \"$creation_date\"\n          }\n        },\n        \"item_name\": 1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"month\": \"$month\"\n        },\n        \"unique_items\": {\n          \"$addToSet\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"month\": \"$_id.month\",\n        \"unique_item_count\": {\n          \"$size\": \"$unique_items\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"unique_item_count\": -1\n      }\n    },\n    {\n      \"$limit\": 10\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders have a total price less than $500 but a unit price greater than $50?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$lt\": 500\n        },\n        \"unit_price\": {\n          \"$gt\": 50\n        }\n      }\n    },\n    {\n      \"$count\": \"num_orders\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total quantity of items ordered from locations in the 95841 zip code?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": \"95841\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for each supplier in the dataset?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Item Names that were ordered in bulk (Quantity > 100) more than 5 times"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"quantity\": {\n          \"$gt\": 100\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"bulk_order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"bulk_order_count\": {\n          \"$gt\": 5\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show Purchase Order Numbers with more than 5 different Commodity Titles"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"purchase_order_number\": \"$purchase_order_number\",\n          \"commodity_title\": \"$commodity_title\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.purchase_order_number\",\n        \"commodity_titles\": {\n          \"$addToSet\": \"$_id.commodity_title\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"commodity_titles.1\": {\n          \"$exists\": true\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"purchase_order_number\": \"$_id\",\n        \"commodity_title_count\": {\n          \"$size\": \"$commodity_titles\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"commodity_title_count\": {\n          \"$gt\": 5\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show weekly patterns of CalCard vs non-CalCard purchases"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"week_number\": {\n          \"$isoWeekYear\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$facet\": {\n        \"calcard\": [\n          {\n            \"$match\": {\n              \"calcard\": true\n            }\n          },\n          {\n            \"$group\": {\n              \"_id\": \"$week_number\",\n              \"total\": {\n                \"$sum\": \"$total_price\"\n              }\n            }\n          }\n        ],\n        \"non_calcard\": [\n          {\n            \"$match\": {\n              \"calcard\": false\n            }\n          },\n          {\n            \"$group\": {\n              \"_id\": \"$week_number\",\n              \"total\": {\n                \"$sum\": \"$total_price\"\n              }\n            }\n          }\n        ]\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show me the trend of average Quantity ordered per month for each Family Title in FY 2013-2014"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"month\": {\n            \"$month\": \"$creation_date\"\n          },\n          \"family_title\": \"$family_title\"\n        },\n        \"avg_quantity\": {\n          \"$avg\": \"$quantity\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.month\": 1,\n        \"_id.family_title\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which week of FY 2013-2014 had the highest total spending (sum of Total Price)?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"week\": {\n            \"$week\": \"$purchase_date\"\n          }\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for all orders with missing purchase dates?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"purchase_date\": null\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count Purchase Order Numbers by Supplier Name where LPA Number is not null"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"lpa_number\": {\n          \"$ne\": null\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"purchase_order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average Total Price by Acquisition Method for each Class Title?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"acquisition_method\": \"$acquisition_method\",\n          \"class_title\": \"$class_title\"\n        },\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which department created the most purchase orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What was the total expenditure for classification code '76121504'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": \"76121504\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show me all purchases where the Total Price is above $10,000 and CalCard is 'Yes'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 10000\n        },\n        \"calcard\": \"Yes\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average spending per supplier?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_spend_per_supplier\": {\n          \"$avg\": \"$total_spend\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average quantity ordered for items classified under 'Furniture'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"segment_title\": \"Furniture\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_quantity\": {\n          \"$avg\": \"$quantity\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average unit price of items classified under 'IT Equipment'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"segment_title\": \"IT Equipment\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"average_unit_price\": {\n          \"$avg\": \"$unit_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition type had the lowest average spending per order?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_type\",\n        \"avg_spending\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"avg_spending\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show months where the order volume was 20% above the yearly average"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          },\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.year\",\n        \"month_counts\": {\n          \"$push\": {\n            \"month\": \"$_id.month\",\n            \"count\": \"$count\"\n          }\n        },\n        \"total_count\": {\n          \"$sum\": \"$count\"\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$month_counts\"\n    },\n    {\n      \"$addFields\": {\n        \"month_avg\": {\n          \"$divide\": [\n            \"$totalCount\",\n            12\n          ]\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"month_counts.above_avg\": {\n          \"$cond\": {\n            \"if\": {\n              \"$gt\": [\n                \"$monthCounts.count\",\n                {\n                  \"$multiply\": [\n                    \"$monthAvg\",\n                    1.2\n                  ]\n                }\n              ]\n            },\n            \"then\": true,\n            \"else\": false\n          }\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"month_counts.above_avg\": true\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"year\": \"$_id.year\",\n        \"month\": \"$month_counts.month\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which location had the largest number of purchase orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"num_purchase_orders\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"num_purchase_orders\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
