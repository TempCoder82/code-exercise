{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the count of Purchase Order Numbers created in the last week of each quarter"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$addFields\": {\n        \"quarter\": {\n          \"$toInt\": {\n            \"$add\": [\n              {\n                \"$divide\": [\n                  {\n                    \"$subtract\": [\n                      {\n                        \"$month\": \"$creation_date\"\n                      },\n                      1\n                    ]\n                  },\n                  3\n                ]\n              },\n              1\n            ]\n          }\n        },\n        \"week\": {\n          \"$week\": \"$creation_date\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"week\": {\n          \"$gte\": 39,\n          \"$lte\": 40\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"quarter\": \"$quarter\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Purchase Order Numbers where same Item Name appears more than twice"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$item_name\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"purchase_order_number\": \"$purchase_order_number\",\n          \"item_name\": \"$item_name\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"count\": {\n          \"$gt\": 2\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.purchase_order_number\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count Purchase Order Numbers by Supplier Code for each month"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$project\": {\n        \"supplier_code\": 1,\n        \"purchase_order_number\": 1,\n        \"month\": {\n          \"$month\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_code\": \"$supplier_code\",\n          \"month\": \"$month\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.supplier_code\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List top 10 Supplier Names by total order count in FY 2013-2014"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"total_orders\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_orders\": -1\n      }\n    },\n    {\n      \"$limit\": 10\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total price for all transactions where the total price exceeds $20,000?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 20000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_price_over_20k\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all suppliers with at least one order exceeding $50,000 in total price."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 50000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders have items with a unit price below $5 but a total price above $100?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"unit_price\": {\n          \"$lt\": 5\n        },\n        \"total_price\": {\n          \"$gt\": 100\n        }\n      }\n    },\n    {\n      \"$count\": \"num_orders\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders are missing location coordinates but include zip codes?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"location\": {\n          \"$exists\": false\n        },\n        \"supplier_zip_code\": {\n          \"$exists\": true\n        }\n      }\n    },\n    {\n      \"$count\": \"orders_missing_location\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show the monthly spending pattern (sum of Total Price) for orders created in FY 2013-2014"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": {\n            \"$year\": \"$creation_date\"\n          },\n          \"month\": {\n            \"$month\": \"$creation_date\"\n          }\n        },\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.year\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which orders have a total price exactly equal to their quantity multiplied by $100?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$eq\": {\n            \"$multiply\": [\n              \"$quantity\",\n              100\n            ]\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total number of transactions made using 'Informal Competitive' acquisition methods?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"Informal Competitive\"\n      }\n    },\n    {\n      \"$count\": \"total_transactions\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Class Title where Total Price exceeds $5000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 5000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$class_title\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show total spending by Family Title where Unit Price ends in .99"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"unit_price\": {\n          \"$regex\": \".99$\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$family_title\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which Department Name had the highest total spending on items with Family Title containing 'Software'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"family_title\": {\n          \"$regex\": \"Software\",\n          \"$options\": \"i\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List the top 10 most expensive purchases by Total Price where Acquisition Method is 'NCB'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"NCB\"\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_price\": -1\n      }\n    },\n    {\n      \"$limit\": 10\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum monthly spending where LPA Number is not null"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"lpa_number\": {\n          \"$ne\": null\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": {\n            \"$year\": \"$creation_date\"\n          },\n          \"month\": {\n            \"$month\": \"$creation_date\"\n          }\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.year\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition method had the highest total spending?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_method\",\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"total_spending\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show order count by Location where CalCard = 'No'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"calcard\": \"No\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which Commodity Title had the highest number of purchases with non-matching Purchase Order Number and Requisition Number?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"purchase_order_number\": {\n          \"$ne\": \"$requisition_number\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$commodity_title\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all suppliers with at least 5 orders."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"order_count\": {\n          \"$gte\": 5\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all Purchase Order Numbers with more than 15 different Item Names"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$item_name\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$purchase_order_number\",\n        \"item_names\": {\n          \"$addToSet\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"item_names.length\": {\n          \"$gt\": 15\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"purchase_order_number\": \"$_id\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders have been placed with suppliers that have 'ISO Certified' qualifications?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_qualifications\": {\n          \"$regex\": \"ISO Certified\",\n          \"$options\": \"i\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all purchases where the Quantity is greater than 100 and Unit Price is less than $50"}, {"role": "assistant", "content": "{\n  \"find\": {\n    \"quantity\": {\n      \"$gt\": 100\n    },\n    \"unit_price\": {\n      \"$lt\": 50\n    }\n  }\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show weekly order count where Classification Codes > 5000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": {\n          \"$elemMatch\": {\n            \"$gt\": \"5000\"\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"week\": {\n          \"$week\": \"$purchase_date\"\n        },\n        \"year\": {\n          \"$year\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"week\": \"$week\",\n          \"year\": \"$year\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many purchase orders were made using the 'WSCA/Coop' method?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"acquisition_method\": \"WSCA/Coop\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the distribution of acquisition types across fiscal years?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"fiscal_year\": \"$fiscal_year\",\n          \"acquisition_type\": \"$acquisition_type\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.fiscal_year\": 1,\n        \"_id.acquisition_type\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List all Item Names that were ordered at least once every month in FY 2013-2014"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            \"2013\",\n            \"2014\"\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"item_name\": \"$item_name\",\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.item_name\",\n        \"months\": {\n          \"$addToSet\": \"$_id.month\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"months\": {\n          \"$size\": 12\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": \"$_id\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which supplier had the largest transaction by total price?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$sort\": {\n        \"total_price\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    },\n    {\n      \"$project\": {\n        \"supplier_name\": 1,\n        \"total_price\": 1,\n        \"_id\": 0\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many suppliers have only one transaction in the entire dataset?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"transaction_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"transaction_count\": 1\n      }\n    },\n    {\n      \"$count\": \"suppliers_with_one_transaction\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition method has the most missing sub-acquisition types?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"acquisition_method\": \"$acquisition_method\",\n          \"sub_acquisition_method\": {\n            \"$cond\": [\n              {\n                \"$eq\": [\n                  \"$sub_acquisition_method\",\n                  null\n                ]\n              },\n              \"MISSING\",\n              \"$sub_acquisition_method\"\n            ]\n          }\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.acquisition_method\",\n        \"missing_count\": {\n          \"$sum\": {\n            \"$cond\": [\n              {\n                \"$eq\": [\n                  \"$_id.sub_acquisition_method\",\n                  \"MISSING\"\n                ]\n              },\n              \"$count\",\n              0\n            ]\n          }\n        },\n        \"total_count\": {\n          \"$sum\": \"$count\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"missing_count\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the average spending per location?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$location\",\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_spend_per_location\": {\n          \"$avg\": \"$total_spend\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show weekly order volume for items with Classification Codes ending in '00'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"classification_codes\": {\n          \"$elemMatch\": {\n            \"$regex\": \"00$\"\n          }\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"week\": {\n          \"$isoWeek\": \"$purchase_date\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"week\": \"$week\"\n        },\n        \"order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.week\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Find all Purchase Order Numbers where Quantity is greater than 100 in IT Services"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"department_name\": \"IT Services\",\n        \"quantity\": {\n          \"$gt\": 100\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"purchase_order_number\": 1,\n        \"_id\": 0\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the distribution of acquisition methods across different locations?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"location\": \"$location\",\n          \"acquisition_method\": \"$acquisition_method\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.location\": 1,\n        \"_id.acquisition_method\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the percentage of total spending for orders from suppliers located in California?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$regex\": \"^9\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"california_spending\": {\n          \"$sum\": \"$total_price\"\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"california_spending_percentage\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$californiaSpending\",\n                \"$totalSpending\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which classification codes have the most items with quantities exceeding 10?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"quantity\": {\n          \"$gt\": 10\n        }\n      }\n    },\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$classification_codes\",\n        \"item_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"item_count\": -1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum Total Price by Department Name where CalCard is 'Yes'"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"calcard\": \"Yes\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$department_name\",\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Compare the average Total Price between purchases with and without LPA Numbers."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"has_lpa\": {\n            \"$cond\": {\n              \"if\": {\n                \"$ne\": [\n                  \"$lpa_number\",\n                  null\n                ]\n              },\n              \"then\": true,\n              \"else\": false\n            }\n          }\n        },\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show monthly spending where Family > 5000 and Class < 6000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"family\": {\n          \"$gt\": \"5000\"\n        },\n        \"class\": {\n          \"$lt\": \"6000\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"year\": {\n            \"$year\": \"$purchase_date\"\n          },\n          \"month\": {\n            \"$month\": \"$purchase_date\"\n          }\n        },\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.year\": 1,\n        \"_id.month\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many orders have a quantity of 1 or less?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"quantity\": {\n          \"$lte\": 1\n        }\n      }\n    },\n    {\n      \"$count\": \"orders_with_quantity_1_or_less\"\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders by Commodity Title where Quantity is prime number"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"quantity\": {\n          \"$in\": [\n            2,\n            3,\n            5,\n            7,\n            11,\n            13,\n            17,\n            19,\n            23,\n            29,\n            31,\n            37,\n            41,\n            43,\n            47,\n            53,\n            59,\n            61,\n            67,\n            71,\n            73,\n            79,\n            83,\n            89,\n            97\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$commodity_title\",\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How many unique classification codes are used for 'IT Goods'?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"commodity_title\": \"IT Goods\"\n      }\n    },\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"unique_codes\": {\n          \"$addToSet\": \"$classification_codes\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"num_unique_codes\": {\n          \"$size\": \"$unique_codes\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the maximum quantity ordered for any single item in fiscal year 2013-2014?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": \"2013-2014\"\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$item_name\",\n        \"max_quantity\": {\n          \"$max\": \"$quantity\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"max_quantity\": -1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Sum weekly spending by Department Name where Total Price > $5000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 5000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"department_name\": \"$department_name\",\n          \"week\": {\n            \"$week\": \"$purchase_date\"\n          }\n        },\n        \"total_spent\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.department_name\",\n        \"weekly_spending\": {\n          \"$push\": {\n            \"week\": \"$_id.week\",\n            \"total_spent\": \"$total_spent\"\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which acquisition type has the most consistent (lowest variance) total price across orders?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_type\",\n        \"prices\": {\n          \"$push\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 1,\n        \"variance\": {\n          \"$stdDevPop\": \"$prices\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"variance\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Compare the average time between Purchase Date and Creation Date across different Acquisition Methods."}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$acquisition_method\",\n        \"avg_time_diff\": {\n          \"$avg\": {\n            \"$divide\": [\n              {\n                \"$subtract\": [\n                  \"$purchase_date\",\n                  \"$creation_date\"\n                ]\n              },\n              86400000\n            ]\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total quantity of items purchased where the total price exceeds $100,000?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 100000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_quantity\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show spending distribution by hour for each Supplier Qualification"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_qualifications\": \"$supplier_qualifications\",\n          \"hour\": {\n            \"$hour\": \"$purchase_date\"\n          }\n        },\n        \"total_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.supplier_qualifications\": 1,\n        \"_id.hour\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show daily spending where Supplier Zip Code matches Location code"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"supplier_zip_code\": {\n          \"$eq\": \"$location\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"date\": \"$creation_date\",\n          \"location\": \"$location\"\n        },\n        \"daily_spend\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.date\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total number of orders and total spending by quarter for FY 2014-2015?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"fiscal_year\": {\n          \"$in\": [\n            2014,\n            2015\n          ]\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"quarter\": {\n          \"$cond\": [\n            {\n              \"$and\": [\n                {\n                  \"$gte\": [\n                    {\n                      \"$month\": \"$purchase_date\"\n                    },\n                    1\n                  ]\n                },\n                {\n                  \"$lte\": [\n                    {\n                      \"$month\": \"$purchase_date\"\n                    },\n                    3\n                  ]\n                }\n              ]\n            },\n            1,\n            {\n              \"$cond\": [\n                {\n                  \"$and\": [\n                    {\n                      \"$gte\": [\n                        {\n                          \"$month\": \"$purchase_date\"\n                        },\n                        4\n                      ]\n                    },\n                    {\n                      \"$lte\": [\n                        {\n                          \"$month\": \"$purchase_date\"\n                        },\n                        6\n                      ]\n                    }\n                  ]\n                },\n                2,\n                {\n                  \"$cond\": [\n                    {\n                      \"$and\": [\n                        {\n                          \"$gte\": [\n                            {\n                              \"$month\": \"$purchase_date\"\n                            },\n                            7\n                          ]\n                        },\n                        {\n                          \"$lte\": [\n                            {\n                              \"$month\": \"$purchase_date\"\n                            },\n                            9\n                          ]\n                        }\n                      ]\n                    },\n                    3,\n                    4\n                  ]\n                }\n              ]\n            }\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"quarter\": \"$quarter\",\n          \"fiscal_year\": \"$fiscal_year\"\n        },\n        \"total_orders\": {\n          \"$sum\": 1\n        },\n        \"total_spending\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What percentage of purchases in each Segment have matching Requisition Numbers and Purchase Order Numbers?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"segment\": \"$segment\",\n          \"has_matching_numbers\": {\n            \"$cond\": {\n              \"if\": {\n                \"$eq\": [\n                  \"$requisition_number\",\n                  \"$purchase_order_number\"\n                ]\n              },\n              \"then\": true,\n              \"else\": false\n            }\n          }\n        },\n        \"total_purchases\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.segment\",\n        \"total\": {\n          \"$sum\": \"$total_purchases\"\n        },\n        \"matching_numbers\": {\n          \"$sum\": {\n            \"$cond\": [\n              \"$_id.has_matching_numbers\",\n              \"$total_purchases\",\n              0\n            ]\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"segment\": \"$_id\",\n        \"percentage_matching\": {\n          \"$multiply\": [\n            {\n              \"$divide\": [\n                \"$matching_numbers\",\n                \"$total\"\n              ]\n            },\n            100\n          ]\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "How does the average Total Price vary by Location within each Class Title?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"location\": \"$location\",\n          \"class_title\": \"$class_title\"\n        },\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"_id.class_title\": 1,\n        \"_id.location\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Which classification code had the lowest average total price per order?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$classification_codes\",\n        \"avg_total_price\": {\n          \"$avg\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"avg_total_price\": 1\n      }\n    },\n    {\n      \"$limit\": 1\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the maximum total price for a single order from each supplier?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": \"$supplier_name\",\n        \"max_total_price\": {\n          \"$max\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List the top 5 Supplier Names by total number of unique Item Names provided"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$item_name\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_name\": \"$supplier_name\",\n          \"item_name\": \"$item_name\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.supplier_name\",\n        \"unique_item_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$sort\": {\n        \"unique_item_count\": -1\n      }\n    },\n    {\n      \"$limit\": 5\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"supplier_name\": \"$_id\",\n        \"unique_item_count\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the total expenditure for all orders where the unit price exceeds $10,000?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"unit_price\": {\n          \"$gt\": 10000\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"total_expenditure\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Item Names that appeared in more than 100 different Purchase Order Numbers"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"item_name\": \"$item_name\",\n          \"purchase_order_number\": \"$purchase_order_number\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.item_name\",\n        \"purchase_order_count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"purchase_order_count\": {\n          \"$gt\": 100\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"item_name\": \"$_id\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Supplier Names that received more than 50% of their total orders in a single quarter"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$group\": {\n        \"_id\": {\n          \"supplier_name\": \"$supplier_name\",\n          \"quarter\": {\n            \"$concat\": [\n              {\n                \"$toString\": {\n                  \"$year\": \"$purchase_date\"\n                }\n              },\n              \"-Q\",\n              {\n                \"$toString\": {\n                  \"$add\": [\n                    {\n                      \"$ceil\": {\n                        \"$divide\": [\n                          {\n                            \"$month\": \"$purchase_date\"\n                          },\n                          3\n                        ]\n                      }\n                    },\n                    {\n                      \"$cond\": [\n                        {\n                          \"$gt\": [\n                            {\n                              \"$mod\": [\n                                {\n                                  \"$month\": \"$purchase_date\"\n                                },\n                                3\n                              ]\n                            },\n                            0\n                          ]\n                        },\n                        0,\n                        1\n                      ]\n                    }\n                  ]\n                }\n              }\n            ]\n          }\n        },\n        \"total_orders\": {\n          \"$sum\": 1\n        },\n        \"total_price\": {\n          \"$sum\": \"$total_price\"\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"max_orders_in_quarter\": {\n          \"$max\": \"$total_orders\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"total_orders\": {\n          \"$gte\": {\n            \"$multiply\": [\n              0.5,\n              \"$max_orders_in_quarter\"\n            ]\n          }\n        }\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"supplier_name\": \"$_id.supplier_name\"\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Show Purchase Order Numbers where all items share same Class Title"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"purchase_order_number\": \"$purchase_order_number\",\n          \"class_title\": \"$class_title\"\n        },\n        \"item_count\": {\n          \"$sum\": 1\n        },\n        \"total_items\": {\n          \"$sum\": \"$quantity\"\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.purchase_order_number\",\n        \"class_titles\": {\n          \"$push\": {\n            \"class_title\": \"$_id.class_title\",\n            \"item_count\": \"$item_count\",\n            \"total_items\": \"$total_items\"\n          }\n        },\n        \"po_item_count\": {\n          \"$sum\": \"$item_count\"\n        }\n      }\n    },\n    {\n      \"$match\": {\n        \"class_titles.item_count\": \"$po_item_count\"\n      }\n    },\n    {\n      \"$project\": {\n        \"_id\": 0,\n        \"purchase_order_number\": \"$_id\",\n        \"class_titles\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "Count orders where Unit Price is higher for smaller Quantities"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$sort\": {\n        \"quantity\": 1,\n        \"unit_price\": -1\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "List Purchase Order Numbers where Segment = 43000000"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"segment\": \"43000000\"\n      }\n    },\n    {\n      \"$project\": {\n        \"purchase_order_number\": 1\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What is the distribution of Classification Codes within each Sub-Acquisition Method?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$unwind\": \"$classification_codes\"\n    },\n    {\n      \"$group\": {\n        \"_id\": {\n          \"sub_acquisition_method\": \"$sub_acquisition_method\",\n          \"classification_code\": \"$classification_codes\"\n        },\n        \"count\": {\n          \"$sum\": 1\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": \"$_id.sub_acquisition_method\",\n        \"classification_codes\": {\n          \"$push\": {\n            \"code\": \"$_id.classification_code\",\n            \"count\": \"$count\"\n          }\n        }\n      }\n    }\n  ]\n}"}]}
{"messages": [{"role": "system", "content": "You are an assistant that converts natural language questions into MongoDB queries. Ensure the query is properly formatted and uses the correct MongoDB operators. Return only the query without any explanations."}, {"role": "user", "content": "What's the average number of days between Creation Date and Purchase Date for orders above $50,000?"}, {"role": "assistant", "content": "{\n  \"aggregate\": true,\n  \"pipeline\": [\n    {\n      \"$match\": {\n        \"total_price\": {\n          \"$gt\": 50000\n        }\n      }\n    },\n    {\n      \"$addFields\": {\n        \"days_between\": {\n          \"$divide\": [\n            {\n              \"$subtract\": [\n                \"$purchase_date\",\n                \"$creation_date\"\n              ]\n            },\n            86400000\n          ]\n        }\n      }\n    },\n    {\n      \"$group\": {\n        \"_id\": null,\n        \"avg_days_between\": {\n          \"$avg\": \"$days_between\"\n        }\n      }\n    }\n  ]\n}"}]}
